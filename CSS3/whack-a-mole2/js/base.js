/* zepto.1.0 */
(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(this===void 0||this===null)throw new TypeError;var c=Object(this),d=c.length>>>0,e=0,f;if(typeof b!="function")throw new TypeError;if(d==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)f=arguments[1];else do{if(e in c){f=c[e++];break}if(++e>=d)throw new TypeError}while(!0);while(e<d)e in c&&(f=b.call(a,f,c[e],e,c)),e++;return f})})();var Zepto=function(){function E(a){return a==null?String(a):y[z.call(a)]||"object"}function F(a){return E(a)=="function"}function G(a){return a!=null&&a==a.window}function H(a){return a!=null&&a.nodeType==a.DOCUMENT_NODE}function I(a){return E(a)=="object"}function J(a){return I(a)&&!G(a)&&a.__proto__==Object.prototype}function K(a){return a instanceof Array}function L(a){return typeof a.length=="number"}function M(a){return g.call(a,function(a){return a!=null})}function N(a){return a.length>0?c.fn.concat.apply([],a):a}function O(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function P(a){return a in j?j[a]:j[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function Q(a,b){return typeof b=="number"&&!l[O(a)]?b+"px":b}function R(a){var b,c;return i[a]||(b=h.createElement(a),h.body.appendChild(b),c=k(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),c=="none"&&(c="block"),i[a]=c),i[a]}function S(a){return"children"in a?f.call(a.children):c.map(a.childNodes,function(a){if(a.nodeType==1)return a})}function T(c,d,e){for(b in d)e&&(J(d[b])||K(d[b]))?(J(d[b])&&!J(c[b])&&(c[b]={}),K(d[b])&&!K(c[b])&&(c[b]=[]),T(c[b],d[b],e)):d[b]!==a&&(c[b]=d[b])}function U(b,d){return d===a?c(b):c(b).filter(d)}function V(a,b,c,d){return F(b)?b.call(a,c,d):b}function W(a,b,c){c==null?a.removeAttribute(b):a.setAttribute(b,c)}function X(b,c){var d=b.className,e=d&&d.baseVal!==a;if(c===a)return e?d.baseVal:d;e?d.baseVal=c:b.className=c}function Y(a){var b;try{return a?a=="true"||(a=="false"?!1:a=="null"?null:isNaN(b=Number(a))?/^[\[\{]/.test(a)?c.parseJSON(a):a:b):a}catch(d){return a}}function Z(a,b){b(a);for(var c in a.childNodes)Z(a.childNodes[c],b)}var a,b,c,d,e=[],f=e.slice,g=e.filter,h=window.document,i={},j={},k=h.defaultView.getComputedStyle,l={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},m=/^\s*<(\w+|!)[^>]*>/,n=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,o=/^(?:body|html)$/i,p=["val","css","html","text","data","width","height","offset"],q=["after","prepend","before","append"],r=h.createElement("table"),s=h.createElement("tr"),t={tr:h.createElement("tbody"),tbody:r,thead:r,tfoot:r,td:s,th:s,"*":h.createElement("div")},u=/complete|loaded|interactive/,v=/^\.([\w-]+)$/,w=/^#([\w-]*)$/,x=/^[\w-]+$/,y={},z=y.toString,A={},B,C,D=h.createElement("div");return A.matches=function(a,b){if(!a||a.nodeType!==1)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=D).appendChild(a),d=~A.qsa(e,b).indexOf(a),f&&D.removeChild(a),d},B=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},C=function(a){return g.call(a,function(b,c){return a.indexOf(b)==c})},A.fragment=function(b,d,e){b.replace&&(b=b.replace(n,"<$1></$2>")),d===a&&(d=m.test(b)&&RegExp.$1),d in t||(d="*");var g,h,i=t[d];return i.innerHTML=""+b,h=c.each(f.call(i.childNodes),function(){i.removeChild(this)}),J(e)&&(g=c(h),c.each(e,function(a,b){p.indexOf(a)>-1?g[a](b):g.attr(a,b)})),h},A.Z=function(a,b){return a=a||[],a.__proto__=c.fn,a.selector=b||"",a},A.isZ=function(a){return a instanceof A.Z},A.init=function(b,d){if(!b)return A.Z();if(F(b))return c(h).ready(b);if(A.isZ(b))return b;var e;if(K(b))e=M(b);else if(I(b))e=[J(b)?c.extend({},b):b],b=null;else if(m.test(b))e=A.fragment(b.trim(),RegExp.$1,d),b=null;else{if(d!==a)return c(d).find(b);e=A.qsa(h,b)}return A.Z(e,b)},c=function(a,b){return A.init(a,b)},c.extend=function(a){var b,c=f.call(arguments,1);return typeof a=="boolean"&&(b=a,a=c.shift()),c.forEach(function(c){T(a,c,b)}),a},A.qsa=function(a,b){var c;return H(a)&&w.test(b)?(c=a.getElementById(RegExp.$1))?[c]:[]:a.nodeType!==1&&a.nodeType!==9?[]:f.call(v.test(b)?a.getElementsByClassName(RegExp.$1):x.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b))},c.contains=function(a,b){return a!==b&&a.contains(b)},c.type=E,c.isFunction=F,c.isWindow=G,c.isArray=K,c.isPlainObject=J,c.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},c.inArray=function(a,b,c){return e.indexOf.call(b,a,c)},c.camelCase=B,c.trim=function(a){return a.trim()},c.uuid=0,c.support={},c.expr={},c.map=function(a,b){var c,d=[],e,f;if(L(a))for(e=0;e<a.length;e++)c=b(a[e],e),c!=null&&d.push(c);else for(f in a)c=b(a[f],f),c!=null&&d.push(c);return N(d)},c.each=function(a,b){var c,d;if(L(a)){for(c=0;c<a.length;c++)if(b.call(a[c],c,a[c])===!1)return a}else for(d in a)if(b.call(a[d],d,a[d])===!1)return a;return a},c.grep=function(a,b){return g.call(a,b)},window.JSON&&(c.parseJSON=JSON.parse),c.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){y["[object "+b+"]"]=b.toLowerCase()}),c.fn={forEach:e.forEach,reduce:e.reduce,push:e.push,sort:e.sort,indexOf:e.indexOf,concat:e.concat,map:function(a){return c(c.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return c(f.apply(this,arguments))},ready:function(a){return u.test(h.readyState)?a(c):h.addEventListener("DOMContentLoaded",function(){a(c)},!1),this},get:function(b){return b===a?f.call(this):this[b>=0?b:b+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(a){return e.every.call(this,function(b,c){return a.call(b,c,b)!==!1}),this},filter:function(a){return F(a)?this.not(this.not(a)):c(g.call(this,function(b){return A.matches(b,a)}))},add:function(a,b){return c(C(this.concat(c(a,b))))},is:function(a){return this.length>0&&A.matches(this[0],a)},not:function(b){var d=[];if(F(b)&&b.call!==a)this.each(function(a){b.call(this,a)||d.push(this)});else{var e=typeof b=="string"?this.filter(b):L(b)&&F(b.item)?f.call(b):c(b);this.forEach(function(a){e.indexOf(a)<0&&d.push(a)})}return c(d)},has:function(a){return this.filter(function(){return I(a)?c.contains(this,a):c(this).find(a).size()})},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!I(a)?a:c(a)},last:function(){var a=this[this.length-1];return a&&!I(a)?a:c(a)},find:function(a){var b,d=this;return typeof a=="object"?b=c(a).filter(function(){var a=this;return e.some.call(d,function(b){return c.contains(b,a)})}):this.length==1?b=c(A.qsa(this[0],a)):b=this.map(function(){return A.qsa(this,a)}),b},closest:function(a,b){var d=this[0],e=!1;typeof a=="object"&&(e=c(a));while(d&&!(e?e.indexOf(d)>=0:A.matches(d,a)))d=d!==b&&!H(d)&&d.parentNode;return c(d)},parents:function(a){var b=[],d=this;while(d.length>0)d=c.map(d,function(a){if((a=a.parentNode)&&!H(a)&&b.indexOf(a)<0)return b.push(a),a});return U(b,a)},parent:function(a){return U(C(this.pluck("parentNode")),a)},children:function(a){return U(this.map(function(){return S(this)}),a)},contents:function(){return this.map(function(){return f.call(this.childNodes)})},siblings:function(a){return U(this.map(function(a,b){return g.call(S(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return c.map(this,function(b){return b[a]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),k(this,"").getPropertyValue("display")=="none"&&(this.style.display=R(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var b=F(a);if(this[0]&&!b)var d=c(a).get(0),e=d.parentNode||this.length>1;return this.each(function(f){c(this).wrapAll(b?a.call(this,f):e?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){c(this[0]).before(a=c(a));var b;while((b=a.children()).length)a=b.first();c(a).append(this)}return this},wrapInner:function(a){var b=F(a);return this.each(function(d){var e=c(this),f=e.contents(),g=b?a.call(this,d):a;f.length?f.wrapAll(g):e.append(g)})},unwrap:function(){return this.parent().each(function(){c(this).replaceWith(c(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(b){return this.each(function(){var d=c(this);(b===a?d.css("display")=="none":b)?d.show():d.hide()})},prev:function(a){return c(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return c(this.pluck("nextElementSibling")).filter(a||"*")},html:function(b){return b===a?this.length>0?this[0].innerHTML:null:this.each(function(a){var d=this.innerHTML;c(this).empty().append(V(this,b,a,d))})},text:function(b){return b===a?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=b})},attr:function(c,d){var e;return typeof c=="string"&&d===a?this.length==0||this[0].nodeType!==1?a:c=="value"&&this[0].nodeName=="INPUT"?this.val():!(e=this[0].getAttribute(c))&&c in this[0]?this[0][c]:e:this.each(function(a){if(this.nodeType!==1)return;if(I(c))for(b in c)W(this,b,c[b]);else W(this,c,V(this,d,a,this.getAttribute(c)))})},removeAttr:function(a){return this.each(function(){this.nodeType===1&&W(this,a)})},prop:function(b,c){return c===a?this[0]&&this[0][b]:this.each(function(a){this[b]=V(this,c,a,this[b])})},data:function(b,c){var d=this.attr("data-"+O(b),c);return d!==null?Y(d):a},val:function(b){return b===a?this[0]&&(this[0].multiple?c(this[0]).find("option").filter(function(a){return this.selected}).pluck("value"):this[0].value):this.each(function(a){this.value=V(this,b,a,this.value)})},offset:function(a){if(a)return this.each(function(b){var d=c(this),e=V(this,a,b,d.offset()),f=d.offsetParent().offset(),g={top:e.top-f.top,left:e.left-f.left};d.css("position")=="static"&&(g.position="relative"),d.css(g)});if(this.length==0)return null;var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(a,c){if(arguments.length<2&&typeof a=="string")return this[0]&&(this[0].style[B(a)]||k(this[0],"").getPropertyValue(a));var d="";if(E(a)=="string")!c&&c!==0?this.each(function(){this.style.removeProperty(O(a))}):d=O(a)+":"+Q(a,c);else for(b in a)!a[b]&&a[b]!==0?this.each(function(){this.style.removeProperty(O(b))}):d+=O(b)+":"+Q(b,a[b])+";";return this.each(function(){this.style.cssText+=";"+d})},index:function(a){return a?this.indexOf(c(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return e.some.call(this,function(a){return this.test(X(a))},P(a))},addClass:function(a){return this.each(function(b){d=[];var e=X(this),f=V(this,a,b,e);f.split(/\s+/g).forEach(function(a){c(this).hasClass(a)||d.push(a)},this),d.length&&X(this,e+(e?" ":"")+d.join(" "))})},removeClass:function(b){return this.each(function(c){if(b===a)return X(this,"");d=X(this),V(this,b,c,d).split(/\s+/g).forEach(function(a){d=d.replace(P(a)," ")}),X(this,d.trim())})},toggleClass:function(b,d){return this.each(function(e){var f=c(this),g=V(this,b,e,X(this));g.split(/\s+/g).forEach(function(b){(d===a?!f.hasClass(b):d)?f.addClass(b):f.removeClass(b)})})},scrollTop:function(){if(!this.length)return;return"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY},position:function(){if(!this.length)return;var a=this[0],b=this.offsetParent(),d=this.offset(),e=o.test(b[0].nodeName)?{top:0,left:0}:b.offset();return d.top-=parseFloat(c(a).css("margin-top"))||0,d.left-=parseFloat(c(a).css("margin-left"))||0,e.top+=parseFloat(c(b[0]).css("border-top-width"))||0,e.left+=parseFloat(c(b[0]).css("border-left-width"))||0,{top:d.top-e.top,left:d.left-e.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||h.body;while(a&&!o.test(a.nodeName)&&c(a).css("position")=="static")a=a.offsetParent;return a})}},c.fn.detach=c.fn.remove,["width","height"].forEach(function(b){c.fn[b]=function(d){var e,f=this[0],g=b.replace(/./,function(a){return a[0].toUpperCase()});return d===a?G(f)?f["inner"+g]:H(f)?f.documentElement["offset"+g]:(e=this.offset())&&e[b]:this.each(function(a){f=c(this),f.css(b,V(this,d,a,f[b]()))})}}),q.forEach(function(a,b){var d=b%2;c.fn[a]=function(){var a,e=c.map(arguments,function(b){return a=E(b),a=="object"||a=="array"||b==null?b:A.fragment(b)}),f,g=this.length>1;return e.length<1?this:this.each(function(a,h){f=d?h:h.parentNode,h=b==0?h.nextSibling:b==1?h.firstChild:b==2?h:null,e.forEach(function(a){if(g)a=a.cloneNode(!0);else if(!f)return c(a).remove();Z(f.insertBefore(a,h),function(a){a.nodeName!=null&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&!a.src&&window.eval.call(window,a.innerHTML)})})})},c.fn[d?a+"To":"insert"+(b?"Before":"After")]=function(b){return c(b)[a](this),this}}),A.Z.prototype=c.fn,A.uniq=C,A.deserializeValue=Y,c.zepto=A,c}();window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(a){function b(a){var b=this.os={},c=this.browser={},d=a.match(/WebKit\/([\d.]+)/),e=a.match(/(Android)\s+([\d.]+)/),f=a.match(/(iPad).*OS\s([\d_]+)/),g=!f&&a.match(/(iPhone\sOS)\s([\d_]+)/),h=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),i=h&&a.match(/TouchPad/),j=a.match(/Kindle\/([\d.]+)/),k=a.match(/Silk\/([\d._]+)/),l=a.match(/(BlackBerry).*Version\/([\d.]+)/),m=a.match(/(BB10).*Version\/([\d.]+)/),n=a.match(/(RIM\sTablet\sOS)\s([\d.]+)/),o=a.match(/PlayBook/),p=a.match(/Chrome\/([\d.]+)/)||a.match(/CriOS\/([\d.]+)/),q=a.match(/Firefox\/([\d.]+)/);if(c.webkit=!!d)c.version=d[1];e&&(b.android=!0,b.version=e[2]),g&&(b.ios=b.iphone=!0,b.version=g[2].replace(/_/g,".")),f&&(b.ios=b.ipad=!0,b.version=f[2].replace(/_/g,".")),h&&(b.webos=!0,b.version=h[2]),i&&(b.touchpad=!0),l&&(b.blackberry=!0,b.version=l[2]),m&&(b.bb10=!0,b.version=m[2]),n&&(b.rimtabletos=!0,b.version=n[2]),o&&(c.playbook=!0),j&&(b.kindle=!0,b.version=j[1]),k&&(c.silk=!0,c.version=k[1]),!k&&b.android&&a.match(/Kindle Fire/)&&(c.silk=!0),p&&(c.chrome=!0,c.version=p[1]),q&&(c.firefox=!0,c.version=q[1]),b.tablet=!!(f||o||e&&!a.match(/Mobile/)||q&&a.match(/Tablet/)),b.phone=!b.tablet&&!!(e||g||h||l||m||p&&a.match(/Android/)||p&&a.match(/CriOS\/([\d.]+)/)||q&&a.match(/Mobile/))}b.call(a,navigator.userAgent),a.__detect=b}(Zepto),function(a){function g(a){return a._zid||(a._zid=d++)}function h(a,b,d,e){b=i(b);if(b.ns)var f=j(b.ns);return(c[g(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||f.test(a.ns))&&(!d||g(a.fn)===g(d))&&(!e||a.sel==e)})}function i(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function j(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function k(b,c,d){a.type(b)!="string"?a.each(b,d):b.split(/\s/).forEach(function(a){d(a,c)})}function l(a,b){return a.del&&(a.e=="focus"||a.e=="blur")||!!b}function m(a){return f[a]||a}function n(b,d,e,h,j,n){var o=g(b),p=c[o]||(c[o]=[]);k(d,e,function(c,d){var e=i(c);e.fn=d,e.sel=h,e.e in f&&(d=function(b){var c=b.relatedTarget;if(!c||c!==this&&!a.contains(this,c))return e.fn.apply(this,arguments)}),e.del=j&&j(d,c);var g=e.del||d;e.proxy=function(a){var c=g.apply(b,[a].concat(a.data));return c===!1&&(a.preventDefault(),a.stopPropagation()),c},e.i=p.length,p.push(e),b.addEventListener(m(e.e),e.proxy,l(e,n))})}function o(a,b,d,e,f){var i=g(a);k(b||"",d,function(b,d){h(a,b,d,e).forEach(function(b){delete c[i][b.i],a.removeEventListener(m(b.e),b.proxy,l(b,f))})})}function t(b){var c,d={originalEvent:b};for(c in b)!r.test(c)&&b[c]!==undefined&&(d[c]=b[c]);return a.each(s,function(a,c){d[a]=function(){return this[c]=p,b[a].apply(b,arguments)},d[c]=q}),d}function u(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var b=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0,b.call(this)}}}var b=a.zepto.qsa,c={},d=1,e={},f={mouseenter:"mouseover",mouseleave:"mouseout"};e.click=e.mousedown=e.mouseup=e.mousemove="MouseEvents",a.event={add:n,remove:o},a.proxy=function(b,c){if(a.isFunction(b)){var d=function(){return b.apply(c,arguments)};return d._zid=g(b),d}if(typeof c=="string")return a.proxy(b[c],b);throw new TypeError("expected function")},a.fn.bind=function(a,b){return this.each(function(){n(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){o(this,a,b)})},a.fn.one=function(a,b){return this.each(function(c,d){n(this,a,b,null,function(a,b){return function(){var c=a.apply(d,arguments);return o(d,b,a),c}})})};var p=function(){return!0},q=function(){return!1},r=/^([A-Z]|layer[XY]$)/,s={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(b,c,d){return this.each(function(e,f){n(f,c,d,b,function(c){return function(d){var e,g=a(d.target).closest(b,f).get(0);if(g)return e=a.extend(t(d),{currentTarget:g,liveFired:f}),c.apply(g,[e].concat([].slice.call(arguments,1)))}})})},a.fn.undelegate=function(a,b,c){return this.each(function(){o(this,b,c,a)})},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d){return!c||a.isFunction(c)?this.bind(b,c||d):this.delegate(c,b,d)},a.fn.off=function(b,c,d){return!c||a.isFunction(c)?this.unbind(b,c||d):this.undelegate(c,b,d)},a.fn.trigger=function(b,c){if(typeof b=="string"||a.isPlainObject(b))b=a.Event(b);return u(b),b.data=c,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(b)})},a.fn.triggerHandler=function(b,c){var d,e;return this.each(function(f,g){d=t(typeof b=="string"?a.Event(b):b),d.data=c,d.target=g,a.each(h(g,b.type||b),function(a,b){e=b.proxy(d);if(d.isImmediatePropagationStopped())return!1})}),e},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return a?this.bind(b,a):this.trigger(b)}}),["focus","blur"].forEach(function(b){a.fn[b]=function(a){return a?this.bind(b,a):this.each(function(){try{this[b]()}catch(a){}}),this}}),a.Event=function(a,b){typeof a!="string"&&(b=a,a=b.type);var c=document.createEvent(e[a]||"Events"),d=!0;if(b)for(var f in b)f=="bubbles"?d=!!b[f]:c[f]=b[f];return c.initEvent(a,d,!0,null,null,null,null,null,null,null,null,null,null,null,null),c.isDefaultPrevented=function(){return this.defaultPrevented},c}}(Zepto),function($){function triggerAndReturn(a,b,c){var d=$.Event(b);return $(a).trigger(d,c),!d.defaultPrevented}function triggerGlobal(a,b,c,d){if(a.global)return triggerAndReturn(b||document,c,d)}function ajaxStart(a){a.global&&$.active++===0&&triggerGlobal(a,null,"ajaxStart")}function ajaxStop(a){a.global&&!--$.active&&triggerGlobal(a,null,"ajaxStop")}function ajaxBeforeSend(a,b){var c=b.context;if(b.beforeSend.call(c,a,b)===!1||triggerGlobal(b,c,"ajaxBeforeSend",[a,b])===!1)return!1;triggerGlobal(b,c,"ajaxSend",[a,b])}function ajaxSuccess(a,b,c){var d=c.context,e="success";c.success.call(d,a,e,b),triggerGlobal(c,d,"ajaxSuccess",[b,c,a]),ajaxComplete(e,b,c)}function ajaxError(a,b,c,d){var e=d.context;d.error.call(e,c,b,a),triggerGlobal(d,e,"ajaxError",[c,d,a]),ajaxComplete(b,c,d)}function ajaxComplete(a,b,c){var d=c.context;c.complete.call(d,b,a),triggerGlobal(c,d,"ajaxComplete",[b,c]),ajaxStop(c)}function empty(){}function mimeToDataType(a){return a&&(a=a.split(";",2)[0]),a&&(a==htmlType?"html":a==jsonType?"json":scriptTypeRE.test(a)?"script":xmlTypeRE.test(a)&&"xml")||"text"}function appendQuery(a,b){return(a+"&"+b).replace(/[&?]{1,2}/,"?")}function serializeData(a){a.processData&&a.data&&$.type(a.data)!="string"&&(a.data=$.param(a.data,a.traditional)),a.data&&(!a.type||a.type.toUpperCase()=="GET")&&(a.url=appendQuery(a.url,a.data))}function parseArguments(a,b,c,d){var e=!$.isFunction(b);return{url:a,data:e?b:undefined,success:e?$.isFunction(c)?c:undefined:b,dataType:e?d||c:c}}function serialize(a,b,c,d){var e,f=$.isArray(b);$.each(b,function(b,g){e=$.type(g),d&&(b=c?d:d+"["+(f?"":b)+"]"),!d&&f?a.add(g.name,g.value):e=="array"||!c&&e=="object"?serialize(a,g,c,b):a.add(b,g)})}var jsonpID=0,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(a){if("type"in a){var b="jsonp"+ ++jsonpID,c=document.createElement("script"),d=function(){clearTimeout(g),$(c).remove(),delete window[b]},e=function(c){d();if(!c||c=="timeout")window[b]=empty;ajaxError(null,c||"abort",f,a)},f={abort:e},g;return ajaxBeforeSend(f,a)===!1?(e("abort"),!1):(window[b]=function(b){d(),ajaxSuccess(b,f,a)},c.onerror=function(){e("error")},c.src=a.url.replace(/=\?/,"="+b),$("head").append(c),a.timeout>0&&(g=setTimeout(function(){e("timeout")},a.timeout)),f)}return $.ajax(a)},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host),settings.url||(settings.url=window.location.toString()),serializeData(settings),settings.cache===!1&&(settings.url=appendQuery(settings.url,"_="+Date.now()));var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=settings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.contentType||settings.contentType!==!1&&settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){xhr.onreadystatechange=empty,clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:$.parseJSON(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,xhr.status?"error":"abort",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(a,b,c,d){return $.ajax(parseArguments.apply(null,arguments))},$.post=function(a,b,c,d){var e=parseArguments.apply(null,arguments);return e.type="POST",$.ajax(e)},$.getJSON=function(a,b,c){var d=parseArguments.apply(null,arguments);return d.dataType="json",$.ajax(d)},$.fn.load=function(a,b,c){if(!this.length)return this;var d=this,e=a.split(/\s/),f,g=parseArguments(a,b,c),h=g.success;return e.length>1&&(g.url=e[0],f=e[1]),g.success=function(a){d.html(f?$("<div>").html(a.replace(rscript,"")).find(f):a),h&&h.apply(d,arguments)},$.ajax(g),this};var escape=encodeURIComponent;$.param=function(a,b){var c=[];return c.add=function(a,b){this.push(escape(a)+"="+escape(b))},serialize(c,a,b),c.join("&").replace(/%20/g,"+")}}(Zepto),function(a){a.fn.serializeArray=function(){var b=[],c;return a(Array.prototype.slice.call(this.get(0).elements)).each(function(){c=a(this);var d=c.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&d!="submit"&&d!="reset"&&d!="button"&&(d!="radio"&&d!="checkbox"||this.checked)&&b.push({name:c.attr("name"),value:c.val()})}),b},a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(b){a.push(encodeURIComponent(b.name)+"="+encodeURIComponent(b.value))}),a.join("&")},a.fn.submit=function(b){if(b)this.bind("submit",b);else if(this.length){var c=a.Event("submit");this.eq(0).trigger(c),c.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(a,b){function s(a){return t(a.replace(/([a-z])([A-Z])/,"$1-$2"))}function t(a){return a.toLowerCase()}function u(a){return d?d+a:t(a)}var c="",d,e,f,g={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},h=window.document,i=h.createElement("div"),j=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,k,l,m,n,o,p,q,r={};a.each(g,function(a,e){if(i.style[a+"TransitionProperty"]!==b)return c="-"+t(a)+"-",d=e,!1}),k=c+"transform",r[l=c+"transition-property"]=r[m=c+"transition-duration"]=r[n=c+"transition-timing-function"]=r[o=c+"animation-name"]=r[p=c+"animation-duration"]=r[q=c+"animation-timing-function"]="",a.fx={off:d===b&&i.style.transitionProperty===b,speeds:{_default:400,fast:200,slow:600},cssPrefix:c,transitionEnd:u("TransitionEnd"),animationEnd:u("AnimationEnd")},a.fn.animate=function(b,c,d,e){return a.isPlainObject(c)&&(d=c.easing,e=c.complete,c=c.duration),c&&(c=(typeof c=="number"?c:a.fx.speeds[c]||a.fx.speeds._default)/1e3),this.anim(b,c,d,e)},a.fn.anim=function(c,d,e,f){var g,h={},i,t="",u=this,v,w=a.fx.transitionEnd;d===b&&(d=.4),a.fx.off&&(d=0);if(typeof c=="string")h[o]=c,h[p]=d+"s",h[q]=e||"linear",w=a.fx.animationEnd;else{i=[];for(g in c)j.test(g)?t+=g+"("+c[g]+") ":(h[g]=c[g],i.push(s(g)));t&&(h[k]=t,i.push(k)),d>0&&typeof c=="object"&&(h[l]=i.join(", "),h[m]=d+"s",h[n]=e||"linear")}return v=function(b){if(typeof b!="undefined"){if(b.target!==b.currentTarget)return;a(b.target).unbind(w,v)}a(this).css(r),f&&f.call(this)},d>0&&this.bind(w,v),this.size()&&this.get(0).clientLeft,this.css(h),d<=0&&setTimeout(function(){u.each(function(){v.call(this)})},0),this},i=null}(Zepto),function(a,b){function h(c,d,e,f,g){typeof d=="function"&&!g&&(g=d,d=b);var h={opacity:e};return f&&(h.scale=f,c.css(a.fx.cssPrefix+"transform-origin","0 0")),c.animate(h,d,null,g)}function i(b,c,d,e){return h(b,c,0,d,function(){f.call(a(this)),e&&e.call(this)})}var c=window.document,d=c.documentElement,e=a.fn.show,f=a.fn.hide,g=a.fn.toggle;a.fn.show=function(a,c){return e.call(this),a===b?a=0:this.css("opacity",0),h(this,a,1,"1,1",c)},a.fn.hide=function(a,c){return a===b?f.call(this):i(this,a,"0,0",c)},a.fn.toggle=function(c,d){return c===b||typeof c=="boolean"?g.call(this,c):this.each(function(){var b=a(this);b[b.css("display")=="none"?"show":"hide"](c,d)})},a.fn.fadeTo=function(a,b,c){return h(this,a,b,null,c)},a.fn.fadeIn=function(a,b){var c=this.css("opacity");return c>0?this.css("opacity",0):c=1,e.call(this).fadeTo(a,c,b)},a.fn.fadeOut=function(a,b){return i(this,a,null,b)},a.fn.fadeToggle=function(b,c){return this.each(function(){var d=a(this);d[d.css("opacity")==0||d.css("display")=="none"?"fadeIn":"fadeOut"](b,c)})}}(Zepto),function(a){function f(f,h){var i=f[e],j=i&&b[i];if(h===undefined)return j||g(f);if(j){if(h in j)return j[h];var k=d(h);if(k in j)return j[k]}return c.call(a(f),h)}function g(c,f,g){var i=c[e]||(c[e]=++a.uuid),j=b[i]||(b[i]=h(c));return f!==undefined&&(j[d(f)]=g),j}function h(b){var c={};return a.each(b.attributes,function(b,e){e.name.indexOf("data-")==0&&(c[d(e.name.replace("data-",""))]=a.zepto.deserializeValue(e.value))}),c}var b={},c=a.fn.data,d=a.camelCase,e=a.expando="Zepto"+ +(new Date);a.fn.data=function(b,c){return c===undefined?a.isPlainObject(b)?this.each(function(c,d){a.each(b,function(a,b){g(d,a,b)})}):this.length==0?undefined:f(this[0],b):this.each(function(){g(this,b,c)})},a.fn.removeData=function(c){return typeof c=="string"&&(c=c.split(/\s+/)),this.each(function(){var f=this[e],g=f&&b[f];g&&a.each(c,function(){delete g[d(this)]})})}}(Zepto),function(a){var b=[],c;a.fn.remove=function(){return this.each(function(){this.parentNode&&(this.tagName==="IMG"&&(b.push(this),this.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",c&&clearTimeout(c),c=setTimeout(function(){b=[]},6e4)),this.parentNode.removeChild(this))})}}(Zepto),function(a){function e(b){return b=a(b),(!!b.width()||!!b.height())&&b.css("display")!=="none"}function j(a,b){a=a.replace(/=#\]/g,'="#"]');var c,d,e=g.exec(a);if(e&&e[2]in f){c=f[e[2]],d=e[3],a=e[1];if(d){var h=Number(d);isNaN(h)?d=d.replace(/^["']|["']$/g,""):d=h}}return b(a,c,d)}var b=a.zepto,c=b.qsa,d=b.matches,f=a.expr[":"]={visible:function(){if(e(this))return this},hidden:function(){if(!e(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(a){if(a===0)return this},last:function(a,b){if(a===b.length-1)return this},eq:function(a,b,c){if(a===c)return this},contains:function(b,c,d){if(a(this).text().indexOf(d)>-1)return this},has:function(a,c,d){if(b.qsa(this,d).length)return this}},g=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),h=/^\s*>/,i="Zepto"+ +(new Date);b.qsa=function(d,e){return j(e,function(f,g,j){try{var k;!f&&g?f="*":h.test(f)&&(k=a(d).addClass(i),f="."+i+" "+f);var l=c(d,f)}catch(m){throw console.error("error performing selector: %o",e),m}finally{k&&k.removeClass(i)}return g?b.uniq(a.map(l,function(a,b){return g.call(a,b,l,j)})):l})},b.matches=function(a,b){return j(b,function(b,c,e){return(!b||d(a,b))&&(!c||c.call(a,null,e)===a)})}}(Zepto),function(a){function h(a){return"tagName"in a?a:a.parentNode}function i(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}function j(){g=null,b.last&&(b.el.trigger("longTap"),b={})}function k(){g&&clearTimeout(g),g=null}function l(){c&&clearTimeout(c),d&&clearTimeout(d),e&&clearTimeout(e),g&&clearTimeout(g),c=d=e=g=null,b={}}var b={},c,d,e,f=750,g;a(document).ready(function(){var m,n;a(document.body).bind("touchstart",function(d){m=Date.now(),n=m-(b.last||m),b.el=a(h(d.touches[0].target)),c&&clearTimeout(c),b.x1=d.touches[0].pageX,b.y1=d.touches[0].pageY,n>0&&n<=250&&(b.isDoubleTap=!0),b.last=m,g=setTimeout(j,f)}).bind("touchmove",function(a){k(),b.x2=a.touches[0].pageX,b.y2=a.touches[0].pageY,Math.abs(b.x1-b.x2)>10&&a.preventDefault()}).bind("touchend",function(f){k(),b.x2&&Math.abs(b.x1-b.x2)>30||b.y2&&Math.abs(b.y1-b.y2)>30?e=setTimeout(function(){b.el.trigger("swipe"),b.el.trigger("swipe"+i(b.x1,b.x2,b.y1,b.y2)),b={}},0):"last"in b&&(d=setTimeout(function(){var d=a.Event("tap");d.cancelTouch=l,b.el.trigger(d),b.isDoubleTap?(b.el.trigger("doubleTap"),b={}):c=setTimeout(function(){c=null,b.el.trigger("singleTap"),b={}},250)},0))}).bind("touchcancel",l),a(window).bind("scroll",l)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(Zepto);
/* checkLogin.0.0.3 */
var CheckLogin=function(){return CheckLogin["init"].apply(CheckLogin,arguments)};(function(exp){exp.init=function(opt){exp.thirdlogin=opt.thirdlogin||true;exp.np=opt.np||"2";var token=exp.getQueryString("token"),LoginFunction=function(){$.pop.popAlert({tips:"需要先登录啦！",subName:"立即登录",icon:"smile",btnFn:function(thisPop){thisPop.fadeOut(100);exp.login()}})};if(opt&&opt.LoginFunction){LoginFunction=opt.LoginFunction}var urlMatch=location.href.match("dianping")?"dianping":"51ping";$.ajax({dataType:"jsonp",url:"http://event."+urlMatch+".com/activities/common/checkToken",data:{token:token},success:function(data){if(typeof data=="string"){data=eval("("+data+")")}if(data.code==200){opt.callback&&opt.callback()}else{LoginFunction()}}})};exp.login=function(){var ua=navigator.userAgent.toLowerCase(),href=window.location.href;if(ua.match(/MicroMessenger/i)){if(exp.thirdlogin){window.location.href="http://m."+location.host.split(".").slice(1,3).join(".")+"/thirdlogin/auth?aType=3&np="+exp.np+"&rurl="+encodeURIComponent(href)}else{window.location.href="http://m."+location.host.split(".").slice(1,3).join(".")+"/login?redir="+encodeURIComponent(href)}}else if(ua.match("dianping")){if(href.indexOf("?")>0){if(href.indexOf("token=")>0){window.location.href=href.replace(/token=([^&]*)(&|$)/,function(a){if(/&$/.test(a)){return"token=!&"}else{return"token=!"}})}else{window.location.href=href+"&token=!"}}else{window.location.href=href+"?token=!"}}else{window.location.href="http://m."+location.host.split(".").slice(1,3).join(".")+"/login?redir="+encodeURIComponent(href)}};exp.getQueryString=function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null}})(CheckLogin);
/* appPop.0.0.9 */
!function(a){function d(a){return function(){a.fadeOut(100)}}function e(a){a.css({display:"block"}),setTimeout(function(){a.animate({left:0},200)},100)}function f(a){confirm("\u60a8\u786e\u5b9a\u8981\u79bb\u5f00\u6b64\u9875\u9762\u5417\uff1f")&&a.animate({left:"100%"},200,"",function(){a.css({display:"none"})})}var b=function(){},c=a('<link rel="stylesheet" href="http://evt.dianping.com/midas/lib/alert/template-app/popAppCss.0.0.3.min.css">');a("head").append(c),b.popAlert=function(b){var k,m,n,o,c=a.extend({},b),e=c.tips||"\u9700\u8981\u5148\u767b\u5f55\u5566!",f=c.subtitle||" ",g=c.subNameOne||"\u53d6\u6d88",h=c.subName||"\u786e\u5b9a",i=c.towBtn||!1,j=c.twoBtn||!1,p=a(".appPop");n="smile"==c.icon?"http://evt.dianping.com/midas/lib/alert/template-app/smile.png":"http://evt.dianping.com/midas/lib/alert/template-app/grimace.png",o=i||j?'<i class="popSubDown">'+g+'</i><i class="popDown">'+h+"</i>":'<i style="margin:0;" class="popDown">'+h+"</i>",m=a('<i class="icon"><img src="'+n+'"></i><h1>'+e+"</h1><p>"+f+'</p><div class="popSub">'+o+"</div>"),0==p.length?(k=a('<article data-role="appPop" class="appPop"><section data-role="popBg" class="popBox"></section></article>'),a("body").prepend(k),a(".popBox").html(m),k.fadeIn(100)):(a(".popBox").html(m),a(".appPop").fadeIn(100)),a(".popSubDown").on("click",function(){var b=a(this).parents(".appPop"),e=c.subDowFn||d(b);e(b)}),a(".popDown").on("click",function(){var b=a(this),e=b.parents(".appPop"),f=c.btnFn||d(e);f(e,b)}),a(".appPop").on("touchmove",function(a){a.preventDefault()})},b.prizeVirtual=function(b){var g,i,j,n,c=a.extend({},b),e=c.subNameOne||"\u786e\u5b9a",f=c.subName||"\u67e5\u770b\u5151\u5956\u51ed\u8bc1",k=a(".appPop"),l=c.towBtn||!1,m=c.twoBtn||!1;j="smile"==c.icon?"http://evt.dianping.com/midas/lib/alert/template-app/smile.png":"http://evt.dianping.com/midas/lib/alert/template-app/grimace.png",n=l||m?'<i class="popSubDown">'+e+'</i><i class="popDown">'+f+"</i>":'<i style="margin:0;" class="popSubDown">'+e+"</i>",i='<i class="icon"><img src="'+j+'"></i><h1>'+c.prizeName+"</h1><h3>"+c.subtitle+'</h3><h4>\u767b\u5f55\u5927\u4f17\u70b9\u8bc4App\u201c\u6211\u7684\u94b1\u5305\u201d\u67e5\u770b\u5151\u5956\u51ed\u8bc1</h4><div class="popSub">'+n+"</div>",0==k.length?(g=a('<article data-role="appPop" class="appPop"><section data-role="popBg" class="popBox"></section></article>'),a("body").prepend(g),a(".popBox").html(i),g.fadeIn(100)):(a(".popBox").html(i),a(".appPop").fadeIn(100)),a(".popSubDown").on("click",function(){var b=a(this).parents(".appPop"),e=c.subDowFn||d(b);e(b)}),a(".popDown").on("click",function(){var b=a(this),e=b.parents(".appPop"),f=c.btnFn||d(e);f(e,b)}),a(".appPop").on("touchmove",function(a){a.preventDefault()})},b.prizeAlert=function(b){var g,i,j,c=a.extend({},b),e=c.subNameOne||"\u53d6\u6d88",f=c.subName||"\u586b\u5199\u6536\u8d27\u5730\u5740",k=a(".appPop");j="smile"==c.icon?"http://evt.dianping.com/midas/lib/alert/template-app/smile.png":"http://evt.dianping.com/midas/lib/alert/template-app/grimace.png",i='<i class="icon"><img src="'+j+'"></i><h1>'+c.prizeName+"</h1><p>"+c.subtitle+'</p><div class="popSub"><div class="popSub"><i class="popSubDown">'+e+'</i><i class="popDown">'+f+"</i></div>",0==k.length?(g=a('<article data-role="appPop" class="appPop"><section data-role="popBg" class="popBox"></section></article>'),a("body").prepend(g),a(".popBox").html(i),g.fadeIn(100)):(a(".popBox").html(i),a(".appPop").fadeIn(100)),a(".popSub").css({marginTop:10,marginBottom:10}),a(".popSubDown").on("click",function(){var b=a(this).parents(".appPop"),e=c.subDowFn||d(b);e(b)}),a(".popDown").on("click",function(){var b=a(this),e=b.parents(".appPop"),f=c.btnFn||d(e);f(e,b)}),a(".appPop").on("touchmove",function(a){a.preventDefault()})},b.verifyInput=function(b){var j,k,l,c=a.extend({},b),d=c.subNameOne||"\u53d6\u6d88",g=c.subName||"\u7acb\u5373\u9a8c\u8bc1",h=c.winSub||"\u63d0\u4ea4",i=c.verify||!1,m=60,n=!0,o=!0,p=a(".verifyInput");k=i?'<section data-role="verifyPhone"><input type="tel" placeholder="\u624b\u673a\u53f7" maxlength="11" id="verifyPhone"><div id="verifyBtn">\u53d1\u9001\u9a8c\u8bc1\u7801</div><input id="verifyCode" type="tel" maxlength="6" placeholder="\u8bf7\u8f93\u51656\u4f4d\u6570\u9a8c\u8bc1\u7801"><div class="verifySub"><i class="popSubDown">'+d+'</i><i class="verifyDown">'+g+"</i></div></section>":'<section data-role="winInor"><input type="text" placeholder="\u6536\u4ef6\u4eba\u59d3\u540d" id="winName"><input type="tel" placeholder="\u624b\u673a\u53f7\u7801" maxlength="11" id="winPhone"><input type="text" placeholder="\u6536\u8d27\u5730\u5740" id="winAddress"><p>\u5956\u54c1\u5c06\u6d3b\u52a8\u7ed3\u675f5\u4e2a\u5de5\u4f5c\u65e5\u5185\u5bc4\u51fa\uff0c\u656c\u8bf7\u67e5\u6536</p><div class="verifySub"><i class="popSubDown">'+d+'</i><i class="popDown">'+h+"</i></section>",0==p.length?(j=a('<article data-role="information" class="verifyInput"></article>'),a("body").prepend(j),a(".verifyInput").html(k),e(a(".verifyInput"))):(a(".verifyInput").html(k),e(a(".verifyInput"))),a("#verifyBtn").on("click",function(){var b=a(this),d=a("#verifyPhone").val();o&&(o=!1,11===d.length&&/0?(13|14|15|17|18)[0-9]{9}/.test(d)&&"1"===d.charAt(0)&&n?(n=!1,b.html("\u5df2\u53d1\u9001("+m+")"),c.verifyFn(d),l=setInterval(function(){m--,m>0?b.html("\u5df2\u53d1\u9001("+m+")"):(b.html("\u83b7\u53d6\u9a8c\u8bc1\u7801"),n=!0,o=!0,clearInterval(l),m=60)},1e3)):(o=!0,a.pop.popAlert({tips:"\u60a8\u7684\u624b\u673a\u53f7\u597d\u50cf\u54ea\u91cc\u4e0d\u5bf9\u54e6",icon:"smile"})))}),a(".popSubDown").on("click",function(){var c=a(this).parents(".verifyInput");b.verifyNoFn?b.verifyNoFn(c):f(c)}),a(".verifyDown").on("click",function(){var b=a(this).parents(".verifyInput"),d=a("#verifyPhone").val(),e=a("#verifyCode").val();11===d.length&&/0?(13|14|15|17|18)[0-9]{9}/.test(d)&&6==e.length&&/^([+-]?)\d*\.?\d+$/.test(e)?c.verifyOkFn(d,e,b):a.pop.popAlert({tips:"\u597d\u50cf\u54ea\u91cc\u4e0d\u5bf9\u54e6",subtitle:"\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801\u548c6\u4f4d\u9a8c\u8bc1\u7801"})}),a(".popDown").on("click",function(){var b=a(this),d=b.parents(".verifyInput"),e=a("#winName").val(),f=a("#winPhone").val(),g=a("#winAddress").val();return 0==e.length?(a.pop.popAlert({tips:"\u59d3\u540d\u4e0d\u80fd\u4e3a\u7a7a\u54e6",icon:"smile"}),void 0):11===f.length&&/0?(13|14|15|17|18)[0-9]{9}/.test(f)&&"1"===f.charAt(0)?0==g.length?(a.pop.popAlert({tips:"\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\u54e6",icon:"smile"}),void 0):(c.winFn(e,f,g,d),void 0):(a.pop.popAlert({tips:"\u60a8\u7684\u624b\u673a\u53f7\u597d\u50cf\u54ea\u91cc\u4e0d\u5bf9\u54e6",icon:"smile"}),void 0)})},b.inputDown=function(a){a.animate({left:"100%"},200,"",function(){a.css({display:"none"})})},a.pop=b}(Zepto);
/* evt-wheremi.1.0.0 */
(function(e){"use strict";var n={version:"7.2.0"};var r=null;var t=!1;n.ready=function(e,n){n()};function i(e,n){for(var r in n){if(!e[r]){e[r]=n[r]}}}function a(e,n){i(e.prototype,n)}var o=TypeError;a(Array,{indexOf:function(e,n){var r=this.length>>>0;n=Number(n)||0;n=Math[n<0?"ceil":"floor"](n);if(n<0){n=Math.max(n+r,0)}for(;n<r;n++){if(n in this&&this[n]===e){return n}}return-1},lastIndexOf:function(e,n){var r=this.length>>>0;n=Number(n)||r-1;n=Math[n<0?"ceil":"floor"](n);if(n<0){n+=r}n=Math.min(n,r-1);for(;n>=0;n--){if(n in this&&this[n]===e){return n}}return-1},filter:function(e,n){var r=[];for(var t=0,i=this.length;t<i;t++){if(t in this&&e.call(n,this[t],t,this)){r.push(this[t])}}return r},forEach:function(e,n){for(var r=0,t=this.length;r<t;r++){if(r in this){e.call(n,this[r],r,this)}}},every:function(e,n){for(var r=0,t=this.length;r<t;r++){if(r in this&&!e.call(n,this[r],r,this)){return false}}return true},map:function(e,n){var r=[],t=0,i=this.length;for(;t<i;t++){if(t in this){r[t]=e.call(n,this[t],t,this)}}return r},some:function(e,n){for(var r=0,t=this.length;r<t;r++){if(r in this&&e.call(n,this[r],r,this)){return true}}return false},reduce:function(e){if(typeof e!=="function"){throw new o(e+" is not an function")}var n=this,t=n.length>>>0,i=0,a;if(arguments.length>1){a=arguments[1]}else{do{if(i in n){a=n[i++];break}if(++i>=t){throw new o("Reduce of empty array with on initial value")}}while(true)}for(;i<t;i++){if(i in n){a=e.call(r,a,n[i],i,n)}}return a},reduceRight:function(e){if(typeof e!=="function"){throw new o(e+" is not an function")}var n=this,t=n.length>>>0,i=t-1,a;if(arguments.length>1){a=arguments[1]}else{do{if(i in n){a=n[i--];break}if(--i<0){throw new o("Reduce of empty array with on initial value")}}while(true)}for(;i>=0;i--){if(i in n){a=e.call(r,a,n[i],i,n)}}return a}});i(Object,{keys:function(){var e=Object.prototype.hasOwnProperty,n=!{toString:""}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],t=r.length;return function(i){if(i!==Object(i)){throw new o("Object.keys called on non-object")}var a=[],c;for(c in i){if(e.call(i,c)){a.push(c)}}if(n){for(var f=0;f<t;f++){if(e.call(i,r[f])){a.push(r[f])}}}return a}}()});a(String,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});var c=/^((?:[^\/])+?)(?:@([^\/]+))?(\/.*)?$/;function f(e){var n=e.match(c);var r=n[1];var t=n[2]||"*";var i=n[3]||"";return u({n:r,v:t,p:i})}function u(e){var n=e.n+"@"+e.v;e.id=n+e.p;e.k=n;return e}function s(e,n){return n.map?e:e+".js"}function l(e,n){for(var r in n){e[r]=n[r]}}var p=/.*(?=\/.*$)/;function v(e){var n=e.match(p);return n?n[0]:e}function g(e,n){return h(v(n.p).slice(1),e)}function d(e,n){e=g(e,n);return e?n.k+"/"+e:n.k}function h(e,n){var r=(e+"/"+n).split("/").filter(Boolean);return m(r).join("/")}function m(e){var n=0;var r=e.length-1;for(;r>=0;r--){var t=e[r];if(t==="."){e.splice(r,1)}else if(t===".."){e.splice(r,1);n++}else if(n){e.splice(r,1);n--}}while(n--){e.unshift("..")}return e}function w(e){return e.indexOf("./")===0||e.indexOf("../")===0}function y(e){throw new Error("neuron: "+e)}function x(e){y("Cannot find module '"+e+"'")}var b={};function j(e){return b[e]||(b[e]=[])}function k(e,n){j(e).push(n)}function O(e,n){var r=j(e);r.forEach(function(e){e(n)})}n.on=k;function q(e,n){e||y("null id");n||(n={});var r=n.map||{};e=r[e]||e;var t;var i=w(e);if(i){n.id||x(e);e=d(e,n);e=s(e,n);t=f(e)}else{e=n.m&&n.m[e]||e;t=f(e)}if(t.k===n.k){t.graph=n.graph}else{var a=S(t.k,n.graph)||[];t.graph=a;t.v=a[0]||t.v;u(t)}return t}function S(e,n){var r=en.graph._;var t=n?n[1]:r;return t&&e in t?en.graph[t[e]]:r}function E(e){return e.loaded?e.exports:N(e)}function N(e){e.loaded=true;var n=e.exports={};var r=K(e.id);var t=v(r);var i=e.factory;i(T(e),n,e,r,t);return e.exports}var A=1;function D(e,n,r){var t=q(e,n);var i=t.graph;var a=C(t);var o=a.main?t.k:t.id;var c=i[o];if(!c){!r||x(e);c=i[o]=R(a);c.graph=i;c.g||(c.g=A++)}return c}function I(e,r){n.ready(e,function(){r(E(e))})}function C(e){var n=e.id;return on[n]||(on[n]={n:e.n,v:e.v,p:e.p,id:n,k:e.k,m:{},l:[],main:!e.p})}function R(e){function n(){this.r=[]}n.prototype=e;return new n}function L(e){!~e.indexOf("@")||y("id with '@' is prohibited")}function T(e){var n=function(n){L(n);var r=D(n,e,true);return E(r)};n.async=function(n,r){var t=n;if(r){L(n);var i=w(n);if(i){n=d(n,e);var a=e.entries;n=a?_(n,a)||_(n+".js",a)||_(n+".json",a)||x(t):s(n,e)}var o=D(n,e);if(!o.main){if(i){o.a=true}else{return}}I(o,r)}};n.resolve=function(n){if(w(n)){n=g(n,e);if(!~n.indexOf("../")){var r=z(e.k,n);n=H(n,r);return K(e.k+"/"+n)}}};return n}function _(e,n){return~n.indexOf(e)?e:t}var P=document;var $=P.getElementsByTagName("head")[0];function J(e){var n=P.createElement("script");n.src=e;n.async=true;M(n,function(){$.removeChild(n)});setTimeout(function(){$.insertBefore(n,$.firstChild)},0)}var M=P.createElement("script").readyState?function(e,n){e.onreadystatechange=function(){var t=e.readyState;if(t==="loaded"||t==="complete"){e.onreadystatechange=r;n.call(this)}}}:function(e,n){e.addEventListener("load",n,false)};function Q(e,n,r,t){t||(t={});var i=q(e);if(i.p){i.p=s(i.p,t);u(i)}var a=i.k;var o;if(t.main){o=on[a]}var c=on[i.id]=o||on[i.id]||C(i);if(t.main){on[a]=c;l(c,i)}l(c,t);if(!c.factory){c.factory=r;c.deps=n;B(n,c.m);var f=t.asyncDeps;if(f){B(f,c.m)}U(c,"l")}}function B(e,n){e.forEach(function(e){var r=e.split("@")[0];n[r]=e})}function U(e,n){var r=e[n];var i;e[n]=t;while(i=r.pop()){i()}}function F(e,n){var r=on[e.id];r.f=e.f;r.a=e.a;var t=r.l;if(t){t.push(n);if(t.length<2){G(r)}}}var W=[];function G(e){if(e.d){return}e.d=true;var n=e.f;var r=e.a;var t=e.k;if(~W.indexOf(t)){if(!n&&!r){return}}else{W.push(t)}var i=en.loaded;var a=n?e.id:t;if(~i.indexOf(a)){if(!r){return}}else{i.push(a)}J(V(e))}function H(e,n){var r=e.match(/\.[\w\d]+$/)[0];if(n){return e.replace(new RegExp(r+"$"),"_"+n+r)}else{return e}}function V(e){var n=z(e.k,e.main?e.n+".js":e.p.slice(1));var r=e.main?e.k+"/"+e.n+".js":e.id;var t=K(r);return H(t,n)}function z(e,n){return en.hash&&en.hash[e]&&en.hash[e][n]}function K(e){var n=e.replace("@","/");var r=en.path;r||y("config.path must be specified");r=r.replace("{n}",n.length%3+1);return r+n}function X(e,n,i){O("beforeready",Z(e)+":"+e.g);if(!e.factory){O("beforeload",e.id);return F(e,function(){O("load",Z(e));X(e,n,i)})}var a=e.deps;var o=a.length;var c=e.r;if(!o||!c){e.r=t;Y(e);return n()}c.push(n);if(c.length>1){return}var f=function(){if(!--o){i.length=0;i=r;Y(e);U(e,"r")}};i=i?[e].concat(i):[e];a.forEach(function(n){var r=D(n,e);if(~i.indexOf(r)){return f()}X(r,f,i)})}function Y(e){O("ready",Z(e)+":"+e.g)}function Z(e){return e.main?e.k:e.id}n.ready=X;var en=n.conf={loaded:[],graph:{_:{}}};var nn={path:function(e){return e.replace(/\/*$/,"/")},hash:rn,loaded:rn,graph:rn};function rn(e){return e}function tn(e){var n;var r;for(n in e){r=nn[n];if(r){en[n]=r(e[n])}}}n.config=tn;e.neuron=n;e.define=Q;e.facade=function(e){an(e.entry,function(n){n.init&&n.init(e.data)})};e._use=function(e,n){an(e,n)};e._load=J;function an(e,n){var r=D(e);r.f=true;I(r,n)}var on=n.mods={}})(this);neuron.config({graph:{0:["0.1.0",{"whereami@~0.1.15":1}],1:["0.1.15",{"cookie@~0.2.0":2,"dpapp@^1.1.11":3,"weixin-js-sdk-loader@~0.1.0":9}],2:["0.2.0"],3:["1.1.20-beta",{"dpapp-core@^1.1.1":4,"mix@^1.0.1":5,"dpapp-share@~0.1.0":8}],4:["1.1.2",{"mix@^1.0.1":5,"promise@^6.1.0":6}],5:["1.0.1"],6:["6.1.0",{"asap@^1.0.0":7}],7:["1.0.0"],8:["0.1.0"],9:["0.1.0",{"events@^1.0.5":10}],10:["1.0.5",{"util@~1.0.0":11}],11:["1.0.5",{"json@~1.0.0":12}],12:["1.0.1"],_:{"event-whereami@0.1.0":0,"event-whereami@*":0}}});neuron.config({path:"http://j2.s2.dpfile.com/mod/"});(function(){function e(e,n){for(var r in n){e[r]=n[r]}return e}var n="cookie@0.2.0/cookie.js";var r={};var t=r;define(n,[],function(e,n,r,t,i){var a=function(e){return Object.prototype.toString.call(e)=="[object Function]"};var o=function(e){Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){for(var r in n){e[r]=n[r]}}});return e};var c=/\+/g;function f(e){return g.raw?e:encodeURIComponent(e)}function u(e){return g.raw?e:decodeURIComponent(e)}function s(e){return f(g.json?JSON.stringify(e):String(e))}function l(e){if(e.indexOf('"')===0){e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{e=decodeURIComponent(e.replace(c," "));return g.json?JSON.parse(e):e}catch(n){}}function p(e,n){var r=g.raw?e:l(e);return a(n)?n(r):r}var v,g,d;g=v=function(e,n,r){if(n!==undefined&&!a(n)){r=o({},g.defaults,r);if(typeof r.expires==="number"){var t=r.expires,i=r.expires=new Date;i.setTime(+i+t*864e5)}return document.cookie=[f(e),"=",s(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}var c=e?undefined:{};var l=document.cookie?document.cookie.split("; "):[];for(var v=0,d=l.length;v<d;v++){var h=l[v].split("=");var m=u(h.shift());var w=h.join("=");if(e&&e===m){c=p(w,n);break}if(!e&&(w=p(w))!==undefined){c[m]=w}}return c};g.defaults={};d=function(e,n){if(v(e)===undefined){return false}v(e,"",o({},n,{expires:-1}));return!v(e)};v.remove=d;r.exports=v},{main:true,map:t})})();(function(){function e(e,n){for(var r in n){e[r]=n[r]}return e}var n="dpapp@^1.1.11";var r="weixin-js-sdk-loader@~0.1.0";var t="whereami@0.1.15/lib/config.js";var i="whereami@0.1.15/lib/request.js";var a="whereami@0.1.15/lib/log.js";var o="whereami@0.1.15/lib/geos/cache.js";var c="whereami@0.1.15/lib/geos/url.js";var f="whereami@0.1.15/lib/geos/weixin.js";var u="whereami@0.1.15/lib/geos/qqbrowser.js";var s="whereami@0.1.15/lib/geos/mobileqq.js";var l="whereami@0.1.15/lib/geos/app.js";var p="whereami@0.1.15/lib/geos/html.js";var v="cookie@~0.2.0";var g="whereami@0.1.15/lib/util.js";var d="whereami@0.1.15/index.js";var h=[n,r];var m={dpapp:n,"weixin-js-sdk-loader":r};var w=m;define(d,[t,i,a,o,c,f,u,s,l,p],function(e,n,r,t,i){var a=e("./lib/config");var o=e("./lib/geos/cache");var c=e("./lib/request");var f=e("./lib/log");var u=[e("./lib/geos/url"),o,e("./lib/geos/weixin"),e("./lib/geos/qqbrowser"),e("./lib/geos/mobileqq"),e("./lib/geos/app"),e("./lib/geos/html")];var s=function(){return!!navigator.userAgent.match(/spider/i)};var l=[],p=[];var v=false;function g(e,n){for(var r=0,t=e.length;r<t;r++){e.shift().apply(this,n||[])}}var d=~location.href.indexOf("debug:whereami");r.exports=function(e,n){if(s()){n();return}e&&l.push(e);n&&p.push(n);if(v){return}v=true;var r=false;var t;var i=a.get("timeout");var h=a.get("disables");var m=+new Date;var w;var y=d||a.get("debug");var x=function(e){clearTimeout(t);v=false;if(r){return}if(y){alert(JSON.stringify(e))}f(m,w,true);if(a.get("city")){c({url:"http://m.dianping.com/getlocalcityid",data:{lat:e.lat,lng:e.lng},onSuc:function(n){if(n.code==200&&n.message){e.city=n.message}g(l,[e])}})}else{g(l,[e])}if(e.type!=="cache"&&h&&!~h.indexOf("cache")){o.set(e.lat,e.lng)}};var b=function(){clearTimeout(t);v=false;if(r){return}g(p);f(m,w,false);f.logError(w,JSON.stringify(Array.prototype.slice.call(arguments,0)))};if(i){t=setTimeout(function(){b("timeout in "+i);r=true},i)}var j=-1;(function k(){j++;if(u[j]){w=u[j].type;if(h&&~h.indexOf(w)){k()}else{if(y){alert("start geos:"+w)}u[j](function(e){e.type=w;x(e)},b,k)}}else{b({message:"no geo support"})}})()};r.exports.config=a.config;r.exports.init=function(){r.exports(function(e){console.log(e)},function(){console.log("fail")})}},{asyncDeps:h,main:true,map:e({"./lib/config":t,"./lib/request":i,"./lib/log":a,"./lib/geos/cache":o,"./lib/geos/url":c,"./lib/geos/weixin":f,"./lib/geos/qqbrowser":u,"./lib/geos/mobileqq":s,"./lib/geos/app":l,"./lib/geos/html":p},w)});define(t,[],function(e,n,r,t,i){var a={timeout:1e4,disables:[],urlParamNames:["latitude","longitude"],cacheType:"cookie",cookieNames:["locallat","locallng"],storageName:"whereami",wxAutoConfig:false,city:false,debug:false};n.get=function(e){return a[e]};n.set=function(e,n){a[e]=n};n.config=function(e){Object.keys(e).forEach(function(n){a[n]=e[n]})}},{asyncDeps:h,map:w});define(i,[],function(e,n,r,t,i){var a=0;var o=function(e,n){if(!n){return e}var r=[];for(var t in n){if(n.hasOwnProperty(t)){r.push(t+"="+n[t])}}return~e.indexOf("?")?e+r.join("&"):e+"?"+r.join("&")};r.exports=function(e){if(!e.url){throw new Error("url request!")}var n=e.data||{};var r=e.onSuc||function(){};var t=n.callback="WhereAmI"+ ++a+ +new Date;var i=document.createElement("script");i.src=o(e.url,n);window[t]=function(e){delete window[t];i.parentNode.removeChild(i);r(e)};document.getElementsByTagName("head")[0].appendChild(i)}},{asyncDeps:h,map:w});define(a,[i],function(e,n,r,t,i){var a=e("./request");r.exports=function(e,n,r){var t="whereami-type-all";var i="whereami-type-"+n;var a={v:1,ts:+new Date,tu:t,d:+new Date-e,hs:r?200:500,ec:""};o(a);a.tu=i;o(a)};var o=function(e){var n=[];for(var r in e){if(e.hasOwnProperty(r)){n.push(r+"="+e[r])}}var t=new Image;t.src="//catdot.dianping.com/broker-service/api/single?"+n.join("&")};r.exports.logError=function(e,n){var r=~location.href.indexOf("dianping.com")?"m.dianping.com":"m.51ping.com";a({url:"//"+r+"/statictest/logevent",data:{name:"WhereAmIFail",info:encodeURIComponent(e+"-"+n)}});if(~n.indexOf("no geo support")){a({url:"//"+r+"/statictest/logevent",data:{name:"WhereAmIFailUA",info:navigator.userAgent}})}}},{asyncDeps:h,map:e({"./request":i},w)});define(o,[v,t],function(e,n,r,t,i){var a=e("cookie");var o=e("../config");var c=o.get("cookieNames");var f=o.get("cacheType");var u=c[0];var s=c[1];var l=o.get("storageName");var p=15;var v=function(){var e=window.localStorage&&window.localStorage!=null;var n="local_test";if(e){try{localStorage.setItem(n,1);localStorage.removeItem(n)}catch(r){return false}}return e};r.exports=function(e,n,r){if(!f){r()}else{if(f=="cookie"){var t=a(u);var i=a(s);if(t&&i){e({lat:t,lng:i})}else{r()}}else if(f=="storage"){if(!v()){r()}else{var o=localStorage.getItem(l);if(o){var c;try{c=JSON.parse(o);if(!c){r()}}catch(g){r()}var d=c.time;var h=+c.lat;var m=+c.lng;if(+new Date-d>p*60*1e3||!h||!m){localStorage.removeItem(l);r()}else{e({lat:h,lng:m})}}else{r()}}}else{r()}}};r.exports.type="cache";r.exports.set=function(e,n){if(!f){return}if(f=="cookie"){var r={expires:p/60/24,path:"/"};if(~location.hostname.indexOf("51ping.com")){r.domain=".51ping.com"}else if(~location.hostname.indexOf("dianping.com")){r.domain=".dianping.com"}a(u,e,r);a(s,n,r)}else if(f=="storage"){if(!v()){return}localStorage.setItem(l,JSON.stringify({lat:e,lng:n,time:+new Date}))}}},{asyncDeps:h,map:e({"../config":t},w)});define(c,[t],function(e,n,r,t,i){var a=e("../config");var o=a.get("urlParamNames");var c=o[0];var f=o[1];var u=new RegExp(c+"=([^$&]+)");var s=new RegExp(f+"=([^$&]+)");r.exports=function(e,n,r){var t=location.search;var i=t.match(u);var a=t.match(s);if(i&&a&&!isNaN(i[1])&&!isNaN(a[1])){e({lat:i[1],lng:a[1]})}else{r()}};r.exports.type="url"},{asyncDeps:h,map:e({"../config":t},w)});define(f,[t,g],function(e,n,r,t,i){var a=e("../config");var o=e("../util");var c=function(){return/MicroMessenger/.test(navigator.userAgent)};r.exports=function(n,r,t){if(!c()){t()}else{var i=function(){if(typeof wx==="undefined"){t();return}wx.ready(function(){wx.checkJsApi({jsApiList:["getLocation"],success:function(e){if(e.checkResult&&e.checkResult.getLocation){wx.getLocation({type:"wgs84",success:function(e){n({lat:e.latitude,lng:e.longitude})},fail:r})}else{t()}},fail:t})})};if(a.get("wxAutoConfig")&&typeof wx==="undefined"){e.async("weixin-js-sdk-loader",function(e){e.use(i)})}else{i()}}};r.exports.type="weixin"},{asyncDeps:h,map:e({"../config":t,"../util":g},w)});define(u,[g],function(e,n,r,t,i){var a=e("../util");var o=function(){return~navigator.userAgent.indexOf("MQQBrowser")};r.exports=function(e,n,r){if(!o()){r()}else{a.loadScript("http://jsapi.qq.com/get?api=app.getGeoLocation",function(){try{browser.app.getGeoLocation(function(r){if(r.ret==="true"){e({lat:r.latitude,lng:r.longitude})}else{n.apply(this,Array.prototype.slice.call(arguments,0))}},n)}catch(t){r()}})}};r.exports.type="qqbrowser"},{asyncDeps:h,map:e({"../util":g},w)});define(s,[g],function(e,n,r,t,i){var a=e("../util");var o=function(){return navigator.userAgent.match(/(.*?(iPad|iPhone|iPod).*?QQ\/([\d\.]+).*?)|(.*?\bV1_AND_SQI?_([\d\.]+)(.*?QQ\/([\d\.]+))?.*?)/i)};r.exports=function(e,n,r){if(!o()){r()}else{a.loadScript("http://m1.s1.dpfile.com/s/j/app/activity/comm/qqapi.428dbe2dc18e9b860465922d6a923595.js",function(){if(!window.mqq||!window.mqq.sensor||!window.mqq.sensor.getLocation){r()}else{mqq.sensor.getLocation({allowCacheTime:60},function(r,t,i){if(r==0&&t&&i){e({lat:t,lng:i})}else{n.apply(this,Array.prototype.slice.call(arguments,0))}})}})}};r.exports.type="mobileqq"},{asyncDeps:h,map:e({"../util":g},w)});define(l,[],function(e,n,r,t,i){var a=function(){return~navigator.userAgent.indexOf("dianping")};r.exports=function(n,r,t){if(!a()){t()}else{e.async("dpapp",function(e){e.ready(function(){e.getLocation({success:function(e){n({lat:e.lat,lng:e.lng})},fail:r})})})}};r.exports.type="app"},{asyncDeps:h,map:w});define(p,[t],function(e,n,r,t,i){var a=e("../config");var o=function(){return!!navigator.geolocation};r.exports=function(e,n,r){if(!o()){r()}else{navigator.geolocation.getCurrentPosition(function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})},function(e){if(e){n({code:e.code,message:e.message})}else{n({message:"unknown error"})}},{enableHighAccuracy:true,maximumAge:3e4,timeout:a.get("timeout")||1e5})}};r.exports.type="html"},{asyncDeps:h,map:e({"../config":t},w)});define(g,[],function(e,n,r,t,i){var a=[];n.loadScript=function(e,n){if(~a.indexOf(e)){n();return}var r=document.createElement("script");r.src=e;r.onload=function(){a.push(e);n()};document.getElementsByTagName("head")[0].appendChild(r)}},{asyncDeps:h,map:w})})();(function(){function e(e,n){for(var r in n){e[r]=n[r]}return e}var n="whereami@~0.1.15";var r="event-whereami@0.1.0/index.js";var t={};var i=t;define(r,[n],function(e,n,r,t,i){"use strict";window.evt_whereami=e("whereami");evt_whereami.config({city:true})},{main:true,map:i})})();_use("event-whereami@0.1.0",function(){});
/* stts.0.7.3 */
window.Stts={init:function(t){if(this.list=t.listCls?$(t.listClass):$(".J_shop-list"),this.tBanner=t.tBannerCls?$(t.tBannerCls):$(".J_banner-top"),this.bBanner=t.bBannerCls?$(t.bBannerCls):$(".J_banner-bottom"),this.buttons=t.buttonsCls?$(t.buttonsCls):$(".J_button"),this.activityId=t.activityId||0,this.itemClass=t.itemCls||"shop",this.city_id=t.cityid||t.cityId||0,this.shopPvArr=[],function(){for(var t=(new Date).getTime()+"_",e=6,i=new Array(0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"),n=0;e>n;n++){var o=Math.floor(36*Math.random());t+=i[o]}this.emidas_request_id=t}(),this.getQuery=function(t){var e=location.search.match(new RegExp("[?&]"+t+"=([^&]+)","i"));return null==e||e.length<1?"":e[1]},this.latitude=this.getQuery("latitude"),this.longtitude=this.getQuery("longtitude"),this.version=this.getQuery("version"),this.source=this.getQuery("utm_source"),!this.source){var e=navigator.userAgent.toLowerCase();e.match(/MicroMessenger/i)?this.source="o_weixin":e.match("dianping")?this.source="o_app":this.source=""}Stts.source=this.source,this.mainAction()},special:function(t){var e=this;_hip.push(["mv",{eventid:e.activityId,type:"emidas_activity",reqid:e.emidas_request_id,action:"click",module:"emidas_activity_button",source:e.source,keyword:t,kid:e.city_id,latitude:e.latitude,longtitude:e.longtitude,version:e.version}])},mainAction:function(){var t=this,e=function(e,i,n){e.index()+1,e.attr("title"),e.attr("href");_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,index:t.index,title:t.title,content:t.content,action:"click",module:t.module,source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version,x:n.pageX,y:n.pageY}])},i=function(e,i,n){e.index()+1,e.attr("title"),e.attr("href");_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,index:t.index,title:t.title,content:t.content,action:"view",module:t.module,source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version,x:n.pageX,y:n.pageY}])},n=function(e){_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,action:"pv",module:t.module,source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version}])},o=function(){_hip.push(["pv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version}])},r=function(){$("body").on("click",function(t){e($(this),"emidas_activity_page",t)}),$("body").on("touchend",function(t){i($(this),"emidas_activity_page",t)})},a=function(){t.tBanner.length>0&&(n("emidas_activity_top_banner"),"A"==t.tBanner[0].tagName?t.tBanner.on("click",function(t){t.stopPropagation(),e($(this),"emidas_activity_top_banner",t)}):t.tBanner.on("click","a",function(t){t.stopPropagation(),e($(this),"emidas_activity_top_banner",t)})),t.bBanner.length>0&&(n("emidas_activity_bottom_banner"),"A"==t.bBanner[0].tagName?t.bBanner.on("click",function(t){t.stopPropagation(),e($(this),"emidas_activity_bottom_banner",t)}):t.bBanner.on("click","a",function(t){t.stopPropagation(),e($(this),"emidas_activity_bottom_banner",t)}))},c=function(){window.JSON||(JSON={},function(){function t(t){return r.lastIndex=0,r.test(t)?'"'+t.replace(r,function(t){var e=a[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function e(r,a){var c,u,s,d,f,l=i,p=a[r];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(r)),"function"==typeof o&&(p=o.call(a,r,p)),typeof p){case"string":return t(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(i+=n,f=[],"[object Array]"===Object.prototype.toString.apply(p)){for(d=p.length,c=0;d>c;c+=1)f[c]=e(c,p)||"null";return s=0===f.length?"[]":i?"[\n"+i+f.join(",\n"+i)+"\n"+l+"]":"["+f.join(",")+"]",i=l,s}if(o&&"object"==typeof o)for(d=o.length,c=0;d>c;c+=1)"string"==typeof o[c]&&(u=o[c],s=e(u,p),s&&f.push(t(u)+(i?": ":":")+s));else for(u in p)Object.prototype.hasOwnProperty.call(p,u)&&(s=e(u,p),s&&f.push(t(u)+(i?": ":":")+s));return s=0===f.length?"{}":i?"{\n"+i+f.join(",\n"+i)+"\n"+l+"}":"{"+f.join(",")+"}",i=l,s}}var i,n,o,r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,r,a){var c;if(i="",n="","number"==typeof a)for(c=0;a>c;c+=1)n+=" ";else"string"==typeof a&&(n=a);if(o=r,r&&"function"!=typeof r&&("object"!=typeof r||"number"!=typeof r.length))throw new Error("JSON.stringify");return e("",{"":t})})}()),t.list.find(t.itemClass).each(function(e,i){var n=($(i),{s:$(i).attr("data-shopid"),i:e+1});t.shopPvArr.push(n)});for(var e=20,i=Math.ceil(t.shopPvArr.length/e),n=[],o=0;i>o;o++)n.push(t.shopPvArr.slice(o*e,(o+1)*e));for(var o=0;o<n.length;o++)_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,action:"pv",shops:JSON.stringify(n[o]),module:"emidas_activity_shop",source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version}])},u=function(){t.list.on("click",".shop",function(e){var i=$(this);t.list.find(".shop").index(i)+1,i.attr("data-shopid"),i.attr("title"),i.attr("href");e.stopPropagation(),_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,shopid:t.shopId,index:t.index,title:t.title,content:t.content,action:"click",module:"emidas_activity_shop",source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version,x:e.pageX,y:e.pageY}])})},s=function(){t.buttons.each(function(e,i){var n=$(i);n.on("click",function(e){n.attr("data-keyword");_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,action:"click",module:"emidas_activity_button",source:t.source,keyword:t.keyword,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version}])})})},d=function(){setTimeout(function(){_hip.push(["mv",{eventid:t.activityId,type:"emidas_activity",reqid:t.emidas_request_id,module:"emidas_activity_close",source:t.source,kid:t.city_id,latitude:t.latitude,longtitude:t.longtitude,version:t.version}])},5e3)},f=function(t){for(var e=window.location.href,i=e.split("?"),n=i[1]?i[1].split("&"):[],o={},r=0;r<n.length;r++){var a=n[r].split("=");o[a[0]]=a[1]}return o[t]},l=function(){var t=f("_fb_"),e=window.location.host.indexOf("dianping.com")>-1?"http://mlog.dianping.com/log":"http://mlog.51ping.com/log";if(t){var i=new Image;e=e+"?"+decodeURIComponent(t)+"&act=4&referer="+encodeURIComponent(document.referrer)+"&t="+(new Date).getTime(),i.src=e}var n,o,r,a=location.search.slice(1),c={},u=0;if(a.indexOf("feedback")>-1||a.indexOf("_fb_")>-1){for(a.indexOf("feedback")>-1&&(n=a.split("feedback=")),a.indexOf("_fb_")>-1&&(n=a.split("_fb_=")),o=n[n.length-1],o=o.indexOf("&")>-1?decodeURIComponent(o.split("&")[0]):decodeURIComponent(o),r=o.split("&"),u;u<r.length;u+=1){var s=r[u].split("=");2==s.length&&(c[s[0]]=s[1])}_hip.push(["mv",c])}};o(),r(),a(),c(),u(),s(),d(),l()}},function(){function t(t){if(C)return t();if(S)return void D.push(t);S=!0,D.push(t);var e=_.DPApp&&_.DPApp.callback,i={_callbacks:{},callback:function(t,i){var n=this._callbacks[t];n&&n.call(this,i),n||e&&e(t,i)},dequeue:function(){},getRequestId:function(t){function e(){o.onload=o.onerror=null,o.parentNode&&o.parentNode.removeChild(o)}var i=t.success;this._callbacks[-1]=function(t){i&&i(t)};var n="js://_?method=getRequestId&args=%7B%7D&callbackId=-1",o=document.createElement("iframe");o.style.display="none",o.onload=o.onerror=e,setTimeout(e,5e3),o.src=n,document.body.appendChild(o)}};if(_.DPApp){if(!_.DPApp.getRequestId)for(var n in i)_.DPApp[n]=i[n]}else _.DPApp=i;v(function(){DPApp.getRequestId({success:function(t){et.reqid=C=t.requestId,D.forEach(function(t){t()}),S=!1}})})}function e(n,o,a,c){if(/dp\/com\.dianping/.test(navigator.userAgent)&&!C)return et.appname="dianping",void t(function(){e(n,o,a,c)});var u=M+F(n,o,a);if(c)return void r(u);var s=setTimeout(function(){A[s]=!1;var t=new Image(1,1);O.push(t),i(t),t.src=u,u=null},0);A[s]=u}function i(t){["onload","onerror","onabort"].forEach(function(e){t[e]=function(){try{t.onload=t.onerror=t.onabort=null}catch(i){}"onabort"===e&&t.src&&r(t.src),n(t,O)}})}function n(t,e){for(var i,n=0,o=e.length;o>n;n++)if(i=e[n],i===t){e.splice(n,1);break}}function o(){return new XMLHttpRequest}function r(t){var e=j();t=t.replace(R,""),e.open("GET",t,!1),e.send()}function a(t){var e,i,n=encodeURIComponent,o=[];for(e in t)i=t[e],Object(i)!==i&&o.push(e+"="+n(i||""));return o.join("&")}function c(t,e,i){var n;if(e){for(n in e)i&&n in t||(t[n]=e[n]);return t}}function u(t,e){return"string"==typeof t&&Object(e)!==e}function s(t,e){return tt._setPageId(t),s}function d(t,e){et[t]=e}function f(t){e(U,[],t||K),K={}}function l(t,e){return t>0?t:e}function p(){it=+new Date}function h(){var t,e=_.performance,i=e&&e.timing,n=it-nt,o=+new Date-nt,r={r_pagetiming:1,r_ready:n,r_load:o};i&&c(r,{r_conn:i.connectEnd-i.connectStart,r_recev:i.responseEnd-i.responseStart,r_ready:l(i.domInteractive-i.domLoading,n),r_wait:i.responseStart-i.requestStart,r_load:l(i.loadEventStart-i.domLoading,o)}),((t=W)||(t=_.DP&&DP.data&&DP.data("hippo_perf_version")))&&(r.test=t),tt.mv(r),ot(_,"load",h)}function v(t){if("complete"===g.readyState)return t();var e=g.documentElement.doScroll,i=e?"readystatechange":"DOMContentLoaded",n=function(){ot(g,i,n),ot(_,"load",n),t()};if(P(g,i,n),P(_,"load",n),e){var o=function(){try{e("left"),n()}catch(t){setTimeout(o,10)}},r=!1;try{r=null==_.frameElement}catch(a){}r&&o()}}var _=window,m=_._hip,g=_.document,y=g.location,b=g.referrer,I=y.href,w=_.screen,k=g.createElement("div"),q="addEventListener",x="removeEventListener",P=k[q]?function(t,e,i,n){t[q](e,i,!!n)}:function(t,e,i){t.attachEvent("on"+e,i)};if(m||(m=_._hip=[]),!m.loaded){m.loaded=!0;var O=[];m.queue=O;var C,S,A={},D=[],j=_.ActiveXObject?function(){if(_.XMLHttpRequest)try{return o()}catch(t){}try{return new _.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}:o,E=!1;_.onbeforeunload=_.onunload=function(){if(!E){E=!0;var t,e;for(t in A)e=A[t],e&&(clearTimeout(Number(t)),r(e))}};var $=0,B=0,N=0,T="www.dianping.com",J=function(){},R="http://hls."+(/51ping/.test(g.domain)?"51ping":"dianping")+".com",M=R+"/hippo.gif?",L="__hsr",X="__hsc",V="__hlh",Q="__hlr",U="__pv",H="__mv",G=function(){return _.JSON&&JSON.stringify||function(t){var e,i,n=[];for(e in t)i=t[e],Object(i)!==i&&n.push('"'+e+'":"'+(""+i).replace(/"/g,'\\"')+'"');return"{"+n.join(",")+"}"}}(),Y=Array.prototype;Y.forEach||(Y.forEach=function(t,e){for(var i=0,n=this.length;n>i;i++)i in this&&t.call(e,this[i],i,this)});var F=function(){var t,e,i,n,o={};return(i=w)&&(t=i.height,e=i.width,t&&e&&(o[L]=e+"x"+t),(n=i.colorDepth)&&(o[X]=n+"bit")),function(t,e,i){i=i||{},c(i,et,!1);var n={__hlt:T,__ppp:$,__had:G(i),force:+new Date};return c(n,o),I&&(n[V]=I),b&&(n[Q]=b),e.push(N+"|"+B),n[t]=e.join("|"),a(n)}}(),K={};c(s,{ext:function(t,e){var i;if(Object(t)===t)for(i in t)s.ext(i,t[i]);else u(t,e)&&(K[t]=e);return s},rxt:function(t){return"string"==typeof t?delete K[t]:arguments.length||(K={}),s},pv:function(t,e){return tt._setCityId(t),tt._setShopType(e),tt._setPVInitData(K),s},mv:function(t,e){return u(t,e)&&(K[t]=e,tt.mv(K)),s}}),document.hippo=s;var W,Z=!0,z=!0,tt={_setPageId:function(t){$=t>>>0},_setCityId:function(t){N=t>>>0},_setShopType:function(t){B=t>>>0},_setPVInitData:function(t){tt._setPVInitData=J,setTimeout(function(){f(t)},0)},_autoPV:function(t){Z=t},_autoPageTiming:function(t){z=t},_setPageTimingVer:function(t){W=t},_setReferrer:function(t){b=t},_setHref:function(t){I=t},_setRequestId:function(t){d("reqid",t)},_setGuid:function(t){d("serverguid",t)},_setCustomConst:d,mv:function(t,i){e(H,["",""],t||K,i),K={}},pv:function(t){f(t)}},et={};m.push=function(t){var e,i;t&&(e=t.shift(),i=tt[e],i&&i.apply(null,t))},m.forEach(function(t){m.push(t)}),Z&&m.push(["_setPVInitData"]),m.length=0;var it,nt=_.G_rtop,ot=k[x]?function(t,e,i,n){t[x](e,i,!!n)}:function(t,e,i){t.detachEvent("on"+e,i)};z&&(v(p),P(_,"load",h)),"undefined"!=typeof module&&module.exports&&(module.exports=m)}}();
/* standalone */
(function(e){"use strict";var n={version:"7.1.2"};var t=null;var r=!1;var i=+new Date;n.ready=function(e,n){n()};function a(e,n){for(var t in n){if(!e[t]){e[t]=n[t]}}}function o(e,n){a(e.prototype,n)}var s=TypeError;o(Array,{indexOf:function(e,n){var t=this.length>>>0;n=Number(n)||0;n=Math[n<0?"ceil":"floor"](n);if(n<0){n=Math.max(n+t,0)}for(;n<t;n++){if(n in this&&this[n]===e){return n}}return-1},lastIndexOf:function(e,n){var t=this.length>>>0;n=Number(n)||t-1;n=Math[n<0?"ceil":"floor"](n);if(n<0){n+=t}n=Math.min(n,t-1);for(;n>=0;n--){if(n in this&&this[n]===e){return n}}return-1},filter:function(e,n){var t=[];for(var r=0,i=this.length;r<i;r++){if(r in this&&e.call(n,this[r],r,this)){t.push(this[r])}}return t},forEach:function(e,n){for(var t=0,r=this.length;t<r;t++){if(t in this){e.call(n,this[t],t,this)}}},every:function(e,n){for(var t=0,r=this.length;t<r;t++){if(t in this&&!e.call(n,this[t],t,this)){return false}}return true},map:function(e,n){var t=[],r=0,i=this.length;for(;r<i;r++){if(r in this){t[r]=e.call(n,this[r],r,this)}}return t},some:function(e,n){for(var t=0,r=this.length;t<r;t++){if(t in this&&e.call(n,this[t],t,this)){return true}}return false},reduce:function(e){if(typeof e!=="function"){throw new s(e+" is not an function")}var n=this,r=n.length>>>0,i=0,a;if(arguments.length>1){a=arguments[1]}else{do{if(i in n){a=n[i++];break}if(++i>=r){throw new s("Reduce of empty array with on initial value")}}while(true)}for(;i<r;i++){if(i in n){a=e.call(t,a,n[i],i,n)}}return a},reduceRight:function(e){if(typeof e!=="function"){throw new s(e+" is not an function")}var n=this,r=n.length>>>0,i=r-1,a;if(arguments.length>1){a=arguments[1]}else{do{if(i in n){a=n[i--];break}if(--i<0){throw new s("Reduce of empty array with on initial value")}}while(true)}for(;i>=0;i--){if(i in n){a=e.call(t,a,n[i],i,n)}}return a}});a(Object,{keys:function(){var e=Object.prototype.hasOwnProperty,n=!{toString:""}.propertyIsEnumerable("toString"),t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=t.length;return function(i){if(i!==Object(i)){throw new s("Object.keys called on non-object")}var a=[],o;for(o in i){if(e.call(i,o)){a.push(o)}}if(n){for(var c=0;c<r;c++){if(e.call(i,t[c])){a.push(t[c])}}}return a}}()});o(String,{trimLeft:function(){return this.replace(/^\s+/,"")},trimRight:function(){return this.replace(/\s+$/,"")},trim:function(){return this.trimLeft().trimRight()}});var c=/^((?:[^\/])+?)(?:@([^\/]+))?(\/.*)?$/;function u(e){var n=e.match(c);var t=n[1];var r=n[2]||"*";var i=n[3]||"";return f({n:t,v:r,p:i})}function f(e){var n=e.n+"@"+e.v;e.id=n+e.p;e.k=n;return e}function l(e,n){return n.map?e:e+".js"}function d(e,n){for(var t in n){e[t]=n[t]}}var p=/.*(?=\/.*$)/;function h(e){var n=e.match(p);return n?n[0]:e}function v(e,n){return m(h(n.p).slice(1),e)}function g(e,n){e=v(e,n);return e?n.k+"/"+e:n.k}function m(e,n){var t=(e+"/"+n).split("/").filter(Boolean);return y(t).join("/")}function y(e){var n=0;var t=e.length-1;for(;t>=0;t--){var r=e[t];if(r==="."){e.splice(t,1)}else if(r===".."){e.splice(t,1);n++}else if(n){e.splice(t,1);n--}}while(n--){e.unshift("..")}return e}function _(e){return e.indexOf("./")===0||e.indexOf("../")===0}function b(e){throw new Error("neuron: "+e)}function k(e){b("Cannot find module '"+e+"'")}var x={};function w(e){return x[e]||(x[e]=[])}function R(e,n){w(e).push(n)}function T(e,n){var t=w(e);t.forEach(function(e){e(n)})}n.on=R;function C(e,n){e||b("null id");n||(n={});var t=n.map||{};e=t[e]||e;var r;var i=_(e);if(i){n.id||k(e);e=g(e,n);e=l(e,n);r=u(e)}else{e=n.m&&n.m[e]||e;r=u(e)}if(r.k===n.k){r.graph=n.graph}else{var a=A(r.k,n.graph)||[];r.graph=a;r.v=a[0]||r.v;f(r)}return r}function A(e,n){var t=K.graph._;var r=n?n[1]:t;return r&&e in r?K.graph[r[e]]:t}function S(e){return e.loaded?e.exports:E(e)}function E(e){e.loaded=true;var n=e.exports={};var t=G(e.id);var r=h(t);var i=e.factory;i(L(e),n,e,t,r);return e.exports}var N=1;function O(e,n,t){var r=C(e,n);var i=r.graph;var a=M(r);var o=a.main?r.k:r.id;var s=i[o];if(!s){!t||k(e);s=i[o]=j(a);s.graph=i;s.g||(s.g=N++)}return s}function I(e,t){n.ready(e,function(){t(S(e))})}function M(e){var n=e.id;return ie[n]||(ie[n]={n:e.n,v:e.v,p:e.p,id:n,k:e.k,m:{},l:[],main:!e.p})}function j(e){function n(){this.r=[]}n.prototype=e;return new n}function D(e){!~e.indexOf("@")||b("id with '@' is prohibited")}function L(e){var n=function(n){D(n);var t=O(n,e,true);return S(t)};n.async=function(n,t){var r=n;if(t){D(n);var i=_(n);if(i){n=g(n,e);var a=e.entries;n=a?P(n,a)||P(n+".js",a)||P(n+".json",a)||k(r):l(n,e)}var o=O(n,e);if(!o.main){if(i){o.a=true}else{return}}I(o,t)}};n.resolve=function(n){if(_(n)){n=v(n,e);if(!~n.indexOf("../")){return G(e.k+"/"+n)}}};return n}function P(e,n){return~n.indexOf(e)?e:r}var U=document;var q=U.getElementsByTagName("head")[0];function B(e){var n=U.createElement("script");n.src=e;n.async=true;F(n,function(){q.removeChild(n)});q.insertBefore(n,q.firstChild)}var F=U.createElement("script").readyState?function(e,n){e.onreadystatechange=function(){var r=e.readyState;if(r==="loaded"||r==="complete"){e.onreadystatechange=t;n.call(this)}}}:function(e,n){e.addEventListener("load",n,false)};function W(e,n,t,r){r||(r={});var i=C(e);if(i.p){i.p=l(i.p,r);f(i)}var a=i.k;var o;if(r.main){o=ie[a]}var s=ie[i.id]=o||ie[i.id]||M(i);if(r.main){ie[a]=s;d(s,i)}d(s,r);if(!s.factory){s.factory=t;s.deps=n;V(n,s.m);var c=r.asyncDeps;if(c){V(c,s.m)}z(s,"l")}}function V(e,n){e.forEach(function(e){var t=e.split("@")[0];n[t]=e})}function z(e,n){var t=e[n];var i;e[n]=r;while(i=t.pop()){i()}}function H(e,n){var t=ie[e.id];t.f=e.f;t.a=e.a;var r=t.l;if(r){r.push(n);if(r.length<2){Q(t)}}}var J=[];function Q(e){if(e.d){return}e.d=true;var n=e.f;var t=e.a;var r=e.k;if(~J.indexOf(r)){if(!n&&!t){return}}else{J.push(r)}var i=K.loaded;var a=n?e.id:r;if(~i.indexOf(a)){if(!t){return}}else{i.push(a)}B($(e))}function $(e){var n=e.main?e.k+"/"+e.n+".js":e.id;return G(n)}function G(e){var n=e.replace("@","/");var t=K.path;t||b("config.path must be specified");t=t.replace("{n}",n.length%3+1);n+=K.cache===false?"?f="+i:"";return t+n}function X(e,n,i){T("beforeready",Z(e)+":"+e.g);if(!e.factory){T("beforeload",e.id);return H(e,function(){T("load",Z(e));X(e,n,i)})}var a=e.deps;var o=a.length;var s=e.r;if(!o||!s){e.r=r;Y(e);return n()}s.push(n);if(s.length>1){return}var c=function(){if(!--o){i.length=0;i=t;Y(e);z(e,"r")}};i=i?[e].concat(i):[e];a.forEach(function(n){var t=O(n,e);if(~i.indexOf(t)){return c()}X(t,c,i)})}function Y(e){T("ready",Z(e)+":"+e.g)}function Z(e){return e.main?e.k:e.id}n.ready=X;var K=n.conf={loaded:[],graph:{_:{}}};var ee={path:function(e){return e.replace(/\/*$/,"/")},loaded:ne,graph:ne,cache:ne};function ne(e){return e}function te(e){var n;var t;for(n in e){t=ee[n];if(t){K[n]=t(e[n])}}}n.config=te;e.neuron=n;e.define=W;e.facade=function(e){re(e.entry,function(n){n.init&&n.init(e.data)})};e._use=function(e,n){re(e,n)};e._load=B;function re(e,n){var t=O(e);t.f=true;I(t,n)}var ie=n.mods={}})(this);neuron.config({graph:{0:["1.1.6",{"dpapp-share@~0.1.0":1,"easy-login@~0.1.3":2}],1:["0.1.0"],2:["0.1.4"],_:{"dpapp@1.1.6":0,"dpapp@*":0}}});neuron.config({path:"http://s1.i{n}.dpfile.com/mod/"});(function(){function e(e,n){for(var t in n){e[t]=n[t]}return e}var n="easy-login@~0.1.3";var t="dpapp-share@~0.1.0";var r="dpapp@1.1.6/lib/apilist.js";var i="dpapp@1.1.6/lib/native-core.js";var a="dpapp@1.1.6/lib/decorator.js";var o="dpapp@1.1.6/lib/errortrace.js";var s="dpapp@1.1.6/lib/patch-7.1.js";var c="dpapp@1.1.6/lib/patch-7.0.js";var u="dpapp@1.1.6/lib/patch-6.x.js";var f="dpapp@1.1.6/lib/web.js";var l="dpapp@1.1.6/lib/core.js";var d="dpapp@1.1.6/lib/queue.js";var p="dpapp@1.1.6/lib/login.css.js";var h="dpapp@1.1.6/index.js";var v=[n,t];var g={"easy-login":n,"dpapp-share":t};var m=g;define(h,[r,i,a,o,s,c,u,f],function(e,n,t,r,i){(function(n){var r;var i;var a=n.navigator.userAgent;var o=e("./lib/apilist");var s=e("./lib/native-core");var c=function(){e("./lib/decorator")(r)};e("./lib/errortrace");function u(){var e=location.search.slice(1);var n={};e.split("&").forEach(function(e){var t=e.split("=");n[t[0]]=t[1]});return n}if(s._uaVersion=="7.1.x"){r=s.extend(e("./lib/patch-7.1"));c()}else if(s._uaVersion=="7.0.x"){r=s.extend(e("./lib/patch-7.0"));c()}else{var f=e("./lib/patch-6.x");var l=e("./lib/web");r=s.extend(f);r._patch6Ready=r.ready;r.ready=function(e){var n=function(){r._trace("ready");e()};if(DPApp._isReady){return n()}var t=setTimeout(function(){r._bindDOMReady(function(){o.forEach(function(e){if(r[e]){delete r[e]}r[e]=l[e]});c();n()})},50);r._patch6Ready(function(){clearTimeout(t);c();n()})}}r.getQuery=u;if(typeof t!=="undefined"){t.exports=r}if(typeof n!=="undefined"){if(n.DPApp){r._mixin(n.DPApp,r)}else{n.DPApp=r}}})(this)},{asyncDeps:v,main:true,map:e({"./lib/apilist":r,"./lib/native-core":i,"./lib/decorator":a,"./lib/errortrace":o,"./lib/patch-7.1":s,"./lib/patch-7.0":c,"./lib/patch-6.x":u,"./lib/web":f},m)});define(r,[],function(e,n,t,r,i){t.exports=["getUserInfo","getUA","getCityId","getLocation","getContactList","getCX","getRequestId","downloadImage","closeWindow","getNetworkType","share","sendSMS","openScheme","jumpToScheme","store","retrieve","ajax","publish","subscribe","unsubscribe","login","setTitle","setBackgroundColor","setLLButton","setLRButton","setRLButton","setRRButton"]},{asyncDeps:v,map:m});define(i,[l,d],function(e,n,t,r,i){var a=t.exports=e("./core");var o=1;var s=e("./queue");var c=s(function(e){a._doSendMessage(e.method,e.args,e.callback)});a.extend({_callbacks:a._callbacks||{},_dequeueTimeout:null,dequeue:function(){clearTimeout(this._dequeueTimeout);this._dequeueTimeout=null;c.dequeue()},_sendMessage:function(e,n,t){var r=this;c.push({method:e,args:n,callback:t});this._dequeueTimeout=setTimeout(function(){r.dequeue()},1e3)},_doSendMessage:function(e,n,t){var r=t&&typeof t=="function";this.log("调用方法",e,n);var i=r?o++:0;if(r){this._callbacks[i]=t}if(!n||typeof n!=="object"){n={}}n.callbackId=i;n=JSON.stringify(n);var a="js://_?method="+e+"&args="+encodeURIComponent(n)+"&callbackId="+i;this._createIframe(a)},_createIframe:function(e){var n=document.createElement("iframe");n.style.display="none";document.body.appendChild(n);function t(){n.onload=n.onerror=null;n.parentNode&&n.parentNode.removeChild(n)}n.onload=n.onerror=t;setTimeout(t,5e3);n.src=e},_send:function(e,n){n=n||{};var t=this;var r=n.success;var i=n.fail;var a=n.handle;var o=function(e){t.log("调用失败",e);i&&i.call(t,e)};var s=function(e){t.log("调用成功",e);r&&r.call(t,e)};var c=function(e){t.log("回调",e);a&&a.call(t,e)};var u=r||i||a?function(e){var n=e.status;if(e.result!="next"){delete e.result}if(n=="success"){s&&s(e)}else if(n=="action"){c&&c(e)}else{o&&o(e)}}:null;this._sendMessage(e,n,u)},_convertUrlParams:function(e){var n=[];for(var t in e){n.push(t+"="+encodeURIComponent(e[t]))}return n.join("&")},_sanitizeAjaxOpts:function(e){e.method=e.method||"get";e.data=e.data||"";var n=e.url;var t=e.data;if(e.method=="get"){var r=[];for(var i in t){if(t.hasOwnProperty(i)&&(t[i]||t[i]===0)){r.push(i+"="+encodeURIComponent(t[i]))}}if(r.length){n+=n.indexOf("?")==-1?"?":"&";n+=r.join("&")}e.url=n;delete e.data}return e},_parseFeed:function(e){var n;if(!e){return 255}else if(e.constructor.toString().indexOf("Array")>=0){n=[0,0,0,0,0,0,0,0];e.forEach(function(e){n[7-e]=1});return parseInt(n.join(""),2)}},_transModel:function(e,n){if(!e){return n}var t={};function r(e){var n=function(e){var n=0,t,r,i;if(e.length==0)return n;for(t=0,i=e.length;t<i;t++){r=e.charCodeAt(t);n=(n<<5)-n+r;n|=0}return n};var t=n(e);return"0x"+(65535&t^t>>>16).toString(16)}function i(e){e.forEach(function(e){t[r(e)]=e})}function a(e){return Object.prototype.toString.call(e)=="[object Array]"}function o(e){return Object.prototype.toString.call(e)=="[object Object]"}function s(e){if(o(e)){delete e.__name;for(var n in e){var r;if(t[n]){r=e[t[n]]=e[n];s(r);delete e[n]}}}else if(a(e)){e.forEach(function(e){s(e)})}return e}e.forEach(function(e){t[r(e)]=e});return s(n)},callback:function(e,n){var t=this._callbacks[e];t&&t.call(this,n);if(n.result=="complete"||n.result=="error"){this._callbacks[e]=null;delete this._callbacks[e]}}})},{asyncDeps:v,map:e({"./core":l,"./queue":d},m)});define(a,[r,l],function(e,n,t,r,i){var a=e("./apilist");var o=e("./core");var s=["getRequestId"];t.exports=function c(e){a.forEach(function(n){if(!e[n]){e[n]=o._notImplemented}});a.forEach(function(n){var t=e[n];if(e[n]&&e[n]._decorated){return}e[n]=function(r){var i=o._mixin({},r);e._trace(n+"_call");var a=i.success;var c=i.fail;var u=function(t){if(!c){if(e.onerror){e.onerror({api:n,err:t})}else{var r=t.errMsg?t.errMsg:JSON.stringify(t);var i=new Error(r);i.name="DPAppError";console.error("`DPApp."+n+"` call faild");e._trace("throw");throw new Error(i)}}else{c(t)}};var f=+new Date;i.success=function(t){e._trace(n+"_success",{time:+new Date-f});a&&a(t)};i.fail=function(t){var i={};i.args=r;i.result=t;e._trace(n+"_fail",{time:+new Date-f,note:JSON.stringify(i)});u(t)};if(!this._isReady&&s.indexOf(n)===-1&&!e._isProduct&&e._uaVersion=="6.9.x"){u("use `DPApp.ready(fn)` to wrap api calls");return}return t.call(e,i)};e[n]._decorated=true;e[n]._notReady=t==e._notImplemented})}},{asyncDeps:v,map:e({"./apilist":r,"./core":l},m)});define(o,[],function(e,n,t,r,i){var a=window.onerror;var o="http://114.80.165.63/broker-service/api/js";window.onerror=function(e,n,t,r,i){var s=encodeURIComponent;var c=Date.now();(new Image).src=o+"?error="+s(e)+"&v=1"+"&data="+s(i&&i.stack?i.stack:"")+"&url="+s(location.href)+"&file="+s(n)+"&line="+s(t)+"&col="+s(r)+"&timestamp="+c;a&&a(e,n,t,r,i)}},{asyncDeps:v,map:m});define(s,[r,c,l],function(e,n,t,r,i){var a=e("./apilist");var o={};var s=e("./patch-7.0");var c=e("./core");var u=function(){var e=navigator.userAgent;var n=e.match(/dp\/[\w\.\d]+\/([\d\.]+)/);var t=n&&n[1];return function(e){var n={};var r=e&&e.success;var i={platform:"dpapp",appName:"dianping",appVersion:t,osName:c._osUA.name,osVersion:c._osUA.version};r&&r(i);return i}}();var f=u();var l=c.Semver.lt(f.appVersion,"7.2.0");var d=t.exports={getUA:u,ready:function(e){var n=this;this._send("ready",{success:function(){n._isReady=true;e()}})},_iOSNetworkType:function(e){var n;var t={kSCNetworkReachabilityFlagsTransientConnection:1<<0,kSCNetworkReachabilityFlagsReachable:1<<1,kSCNetworkReachabilityFlagsConnectionRequired:1<<2,kSCNetworkReachabilityFlagsConnectionOnTraffic:1<<3,kSCNetworkReachabilityFlagsInterventionRequired:1<<4,kSCNetworkReachabilityFlagsConnectionOnDemand:1<<5,kSCNetworkReachabilityFlagsIsLocalAddress:1<<16,kSCNetworkReachabilityFlagsIsDirect:1<<17,kSCNetworkReachabilityFlagsIsWWAN:1<<18};var r=+e.type;var i=e.subType;var a;function o(e){switch(e){case"CTRadioAccessTechnologyGPRS":case"CTRadioAccessTechnologyEdge":case"CTRadioAccessTechnologyCDMA1x":return"2g";case"CTRadioAccessTechnologyLTE":return"4g";case"CTRadioAccessTechnologyWCDMA":case"CTRadioAccessTechnologyHSDPA":case"CTRadioAccessTechnologyHSUPA":case"CTRadioAccessTechnologyCDMA1x":case"CTRadioAccessTechnologyCDMAEVDORev0":case"CTRadioAccessTechnologyCDMAEVDORevA":case"CTRadioAccessTechnologyCDMAEVDORevB":case"CTRadioAccessTechnologyeHRPD":return"3g"}}if((r&t.kSCNetworkReachabilityFlagsReachable)==0){return"none"}if((r&t.kSCNetworkReachabilityFlagsConnectionRequired)==0){a="wifi"}if((r&t.kSCNetworkReachabilityFlagsConnectionOnDemand)!=0||(r&t.kSCNetworkReachabilityFlagsConnectionOnTraffic)!=0){if((r&t.kSCNetworkReachabilityFlagsInterventionRequired)==0){a="wifi"}}if((r&t.kSCNetworkReachabilityFlagsIsWWAN)==t.kSCNetworkReachabilityFlagsIsWWAN){a=o(i)}return a},_androidNetworkType:function(e){var n=e.type;var t=e.subType;if(n==0){switch(t){case 1:case 2:case 4:case 7:case 11:return"2g";case 3:case 5:case 6:case 8:case 9:case 10:case 12:case 14:case 15:return"3g";case 13:return"4g"}}if(n==1){return"wifi"}else{return"none"}},getNetworkType:function(e){var n=e.success;this._send("getNetworkType",{success:function(e){var t=this.getUA();var r;switch(t.osName){case"iphone":r=this._iOSNetworkType(e);break;case"android":r=this._androidNetworkType(e);break}n&&n({networkType:r,raw:{type:e.type,subType:e.subType}})},fail:e.fail})},share:function(e){e.feed=this._parseFeed(e.feed);this._send("share",e)},initShare:function(e){var n=this;this.setRRButton({icon:"H5_Share",handle:function(){n.share({title:e.title,desc:e.desc,content:e.content,image:e.image,feed:e.feed,url:e.url,success:e.success,fail:e.fail})}})},subscribe:function(e){var n=e.action;var t=e.success;var r=e.handle;if(o[n]){e.success&&e.success();o[n].push(r)}else{this._send("subscribe",{action:n,success:e.success,handle:function(){o[n].forEach(function(e){e&&e()})}});o[n]=[r]}},unsubscribe:function(e){var n=e.action;var t=e.success;var r=e.handle;var i=o[n]?o[n].indexOf(r):-1;if(i!=-1){o[n].splice(i,1);t&&t()}else{this._send("unsubscribe",{action:n,success:t})}},pay:s.pay,ajax:function(e){e=this._sanitizeAjaxOpts(e);var n=e.success;e.success=function(t){var r=JSON.parse(t.mapiResult);r=this._transModel(e.keys,r);n(r)};this._send("mapi",e)},uploadImage:function(e){var n=e.success;var t=e.fail;var r=e.handle;this._sendMessage("uploadImage",e,function(e){var n=e.status;if(n=="fail"){t&&t(e);return}else{r&&r(e)}})},openScheme:function(e){var n=e.url;var t=e.extra;if(t){n+="?"+this._convertUrlParams(t);delete e.extra;e.url=n}this._send("openScheme",e)},jumpToScheme:l?c._notImplemented:function(e){var n=e.url;var t=e.extra;if(t){n+="?"+this._convertUrlParams(t);delete e.extra;e.url=n}e.toHome=!!e.toHome?1:0;this._send("jumpToScheme",e)},_getBizName:function(e,n){var t=e.fail;var r=this._cfg.bizname;if(!r){t&&t("use `DPApp.config({bizname:'<your-bizname>'})` first");return false}else{return r}},store:l?c._notImplemented:function(e){var n=this._getBizName(e);if(n){e.key=n+":"+e.key;this._send("store",e)}},updateAccount:function(e){e=e||{};var n=this;var t=document.cookie.match(/dper=\w+/);if(t){t=t[0].split("=")[1]}if(e.dper){t=e.dper}if(!t){return e.fail&&e.fail("Missing dper")}n.ajax({url:"http://m.api.dianping.com/mlogin/convertdper.api",data:{dper:t},keys:["Token","NewToken"],success:function(e){n._send("loginsuccess",{token:e.Token,newtoken:e.NewToken})},fail:e.fail})},retrieve:l?c._notImplemented:function(e){var n=this._getBizName(e);if(n){e.key=n+":"+e.key;this._send("retrieve",e)}},publish:function(e){if(l){return this._send("publish",e)}var n=this._getBizName(e);var t=["phoneChanged","AccountBindChange"];if(n){if(t.indexOf(e.action)==-1){e.action=n+":"+e.action}this._send("publish",e)}},login:function(e){var n=this;function t(e){n.getUserInfo({success:e})}t(function(r){if(r.token){e.success&&e.success(r)}else{var i=function(){t(function(n){e.success&&e.success(n)});this.unsubscribe({action:"loginSuccess",handle:i})};n.subscribe({action:"loginSuccess",handle:i});n.openScheme({url:"dianping://login"})}})}};a.forEach(function(e){if(!d[e]){d[e]=function(n){this._send(e,n)}}})},{asyncDeps:v,map:e({"./apilist":r,"./patch-7.0":c,"./core":l},m)});define(c,[l,u],function(e,n,t,r,i){var a=e("./core");var o=e("./patch-6.x");var s=t.exports=a._mixin(o,{getUA:function(e){var n={};var t=e&&e.success;var r=navigator.userAgent.match(/MApi\s[\w\.]+\s\([\w\.\d]+\s([\d\.]+)/)[1];var i={platform:"dpapp",appName:"dianping",appVersion:r,osName:this._osUA.name,osVersion:this._osUA.version};t&&t(i);return i},ready:function(e){e();this._isReady=true},Share:a.Share,pay:function(e){var n=this;var t=e.payType;var r=e.success;var i=e.fail;var a=e.cx;function o(e,n){DPApp.ajax({url:"http://api.p.dianping.com/payorder.pay",data:e,keys:["Content"],success:function(e){n(null,e)},fail:function(e){n("fail payorder")}})}function s(e){var n=1;var t=7;var r="5:1:null#219#0";var i="11:1:null#217#0";if(e==t){paymentTool=i}else{paymentTool=r}return paymentTool}o({token:e.token,orderid:e.orderId,paymenttool:s(t),cx:a},function(e,a){if(e){return i&&i(e)}n._sendMessage("pay",{paytype:t,paycontent:a.Content},function(e){if(e.payresult){r&&r(e)}else{i&&i(e)}})})},uploadImage:function(e){var n=e.success;var t=e.fail;var r=e.handle;this._sendMessage("uploadImage",e,function(e){var n=e.status;if(n=="fail"){t&&t(e);return}else{r&&r(e)}})},closeWindow:function(){this._sendMessage("close_web")}})},{asyncDeps:v,map:e({"./core":l,"./patch-6.x":u},m)});define(u,[l],function(e,n,t,r,i){var a=e("./core");var o=function(){};var s={};var c={};function u(e,n){var t=c[e];if(t){t.forEach(function(e){e(n)});delete c[e]}}var f=t.exports={_sendMessage:function(e,n,t){this._doSendMessage(e,n,t)},_getEnv:function(e){this._sendMessage("getEnv",null,function(n){s=n;e.call(this,n)})},Share:{WECHAT_FRIENDS:7,WECHAT_TIMELINE:6,QQ:5,SMS:4,WEIBO:3,QZONE:2,EMAIL:1,COPY:0},getUA:function(e){var n=e&&e.success;var t={platform:"dpapp",appName:"dianping",appVersion:s&&s.version,osName:a._osUA.name,osVersion:a._osUA.version};n&&n(t);return t},initShare:function(e){var n=e.success;var t=e.fail;var r="dpshare://_?content=";r+=encodeURIComponent(JSON.stringify({title:e.title,desc:e.desc,image:e.image,feed:this._parseFeed(e.feed),url:e.url}));this.shareCallback=function(e){if(e.status=="success"){n&&n(e)}else{t&&t(e)}};this._createIframe(r)},shareCallback:function(){},getCityId:function(e){var n=e.success;this._getEnv(function(e){n&&n({cityId:e.cityid})})},getNetworkType:function(e){var n=e.success;this._getEnv(function(e){n&&n({networkType:e.network})})},getUserInfo:function(e){var n=e.success;this._getEnv(function(e){n&&n({token:e.token,dpid:e.dpid,userId:e.userId})})},getLocation:function(e){var n=e.success;this._getEnv(function(e){n&&n({lat:e.latitude,lng:e.longitude})})},getCX:function(e){var n=e.business;var t=e.success;this._sendMessage("cx",{business:n},t)},closeWindow:function(){this._sendMessage("close_web")},setTitle:function(e){document.title=e.title;var n=e.success;var t=e.title;this._sendMessage("setTitle",{title:t},function(){})},openScheme:function(e){var n=e.url;var t=e.extra;if(t){n+="?"+this._convertUrlParams(t)}this._sendMessage("actionScheme",{url:n})},jumpToScheme:function(e){var n=e.url;var t=e.extra;if(t){n+="?"+this._convertUrlParams(t)}this._sendMessage("jumpToScheme",{url:n})},ajax:function(e){e=this._sanitizeAjaxOpts(e);var n=this;var t=e.success;var r=e.fail;function i(e){var n={};if(e&&e.length>0){try{n=JSON.parse(e)}catch(t){}}return n}this._sendMessage("ajax",e,function(n){if(n.code==0){var a=this._mixin(i(n.responseText),this._transModel(e.keys,i(n.hashJson)));t&&t(a)}else{r&&r({code:n.code,errMsg:n.message})}})},ready:function(e){var n=this;this._getEnv(function(){n._isReady=true;e.call(n)})},share:function(e){if(!e.feed){e.feed=255}else if(e.feed.constructor.toString().indexOf("Array")>=0){var n=[0,0,0,0,0,0,0,0];e.feed.forEach(function(e){n[7-e]=1});e.feed=parseInt(n.join(""),2)}this._sendMessage("share",e)},isStatusOK:o,did_handle_callback:o};["subscribe","getRequestId","uploadImage","getContactList","unsubscribe","publish","setLLButton","setLRButton","setRLButton","setRRButton"].forEach(function(e){f[e]=a.notImplemented})},{asyncDeps:v,map:e({"./core":l},m)});define(f,[p,l],function(e,n,t,r,i){var a=e("./core");var o=e("./login.css.js");var s={};a._mixin(s,{getUA:function(e){var n=e&&e.success;var t={platform:"web",appName:null,appVersion:null,osName:a._osUA.name,osVersion:a._osUA.version};n&&n(t);return t},ready:a._bindDOMReady,ajax:function(e){var n="GET";var t=e.url;var r=(e.method||n).toUpperCase();var i=e.headers||{};var a=e.data;var o=e.success;var s=e.fail;var c=new XMLHttpRequest;if(!t){t=location.href.split("?")[0]}if(r===n&&a){t+=u(a);a=null}if(r!==n){c.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}function u(e){var n="";for(var t in e){n+=t+"="+encodeURIComponent(e[t])}return n}c.onreadystatechange=function(){if(c.readyState==4){c.onreadystatechange=function(){};var e,n=false;if(c.status>=200&&c.status<300||c.status==304){e=c.responseText;try{e=/^\s*$/.test(e)?null:JSON.parse(e)}catch(t){n=t}if(n)s&&s("ERR_PARSE_JSON");else o(e)}else{s&&s(c.statusText)}}};c.open(e.method,t,true,e.username,e.password);for(var f in i){c.setRequestHeader(f,i[f])}c.send(a)},closeWindow:function(){window.close()}});a._mixin(s,{getLocation:function(e){var n=e.success;var t=e.fail;navigator.geolocation.getCurrentPosition(function(e){n&&n({lat:e.coords.latitude,lng:e.coords.longitude})},function(){t&&t("ERR_GET_LOCATION")})},getCityId:function(e){var n=document.cookie.match(/cy=(\d+)/);n=n?+n[1]:null;e&&e.success&&e.success({cityId:n})}});a._mixin(s,{pay:function(e){},share:function(n){var t=n.success;var r=n.handle;var i=n.title;var a=n.desc;var o=n.content;var s=n.image;var c=n.url;e.async("dpapp-share",function(e){e.pop({title:i,desc:a,content:o,pic:s,url:c});t&&t()})},login:function(n){var t;e.async("easy-login",function(e){if(!t){t=document.createElement("style");t.setAttribute("type","text/css");t.innerHTML=o;document.getElementsByTagName("head")[0].appendChild(t)}var r=document.createElement("div");var i=document.createElement("input");r.setAttribute("class","dpapp-login-panel");i.value="登录";i.type="button";i.setAttribute("class","login-btn");document.body.appendChild(r);var a=e(r,{platform:"mobile",channel:n.channel||"1"});a.on("info",function(e){console.log(e)});a.on("error",function(e){n.fail&&n.fail()});a.on("login",function(){n.success&&n.success();r.parentNode.removeChild(r)});r.appendChild(i);i.onclick=function(){a.login()}})}});a._mixin(s,{setTitle:function(e){var n=e.title;if(n){document.title=n}}});var c={};a._mixin(s,{subscribe:function(e){var n=e.action;var t=e.success;var r=e.handle;var i=e.fail;if(!n||!r){i&&i("missing params");return}if(c[n]){c[n].push(r)}else{c[n]=[r]}t&&t()},unsubscribe:function(e){var n=e.action;var t=e.success;var r=e.handle;var i=e.fail;if(!n){i&&i("Missing params");return}var a=c;var o=a[n];if(!o){t&&t();return}if(r){var s=o.indexOf(r);a[n]=o.splice(s,1)}else{delete a[n]}t&&t()},publish:function(e){if(!e.action){return}var n=e.action;var t=e.data;var r=e.success;var i=c[n];i&&i.forEach(function(e){e(t)});r&&r()}});t.exports=s},{asyncDeps:v,map:e({"./login.css.js":p,"./core":l},m)});define(l,[],function(e,n,t,r,i){function a(e,n){for(var t in n){e[t]=n[t]}return e}var o=t.exports={_cfg:{debug:false},_isProduct:!!location.href.match(".dianping.com"),_isReady:false,config:function(e){for(var n in e){this._cfg[n]=e[n]}},_bindDOMReady:function(e){var n=this;var t=/complete|loaded|interactive/;if(t.test(document.readyState)&&document.body){n._isReady=true;e()}else{document.addEventListener("DOMContentLoaded",function(){n._isReady=true;e()},false)}},Semver:{eq:function(e,n){return e===n},gt:function(e,n){var t=e.split(".");var r=n.split(".");if(+t[0]!==+r[0]){return t[0]>r[0]}else{if(+t[1]!==r[1]){return+t[1]>r[1]}else{return t[2]>r[2]}}},lt:function(e,n){return!this.gte(e,n)},gte:function(e,n){return this.eq(e,n)||this.gt(e,n)},lte:function(e,n){return this.eq(e,n)||this.lt(e,n)}},Share:{WECHAT_FRIENDS:0,WECHAT_TIMELINE:1,QQ:2,SMS:3,WEIBO:4,QZONE:5,EMAIL:6,COPY:7},_osUA:function(){var e=navigator.userAgent;var n,t;if(e.match(/iPhone/)){n="iphone";t=e.match(/iPhone\sOS\s([\d_]+)/i)[1].replace(/_/g,".")}else if(e.match(/Android/)){n="android";t=e.match(/Android\s([\w\.]+)/)[1]}else{n=null;t=null}return{name:n,version:t}}(),_uaVersion:function(){var e=navigator.userAgent;if(/dp\/com\.dianping/.test(e)){return"7.1.x"}else if(/MApi/.test(e)){return"7.0.x"}else{return"6.9.x"}}(),_trace:function(e,n){var t=this._cfg&&this._cfg.logFact||.05;n=n||{};n=this._mixin(n,{module:"dpapp_"+e});if(Math.random()<t){console.log("_trace",e);window._hip&&_hip.push(["mv",n])}},log:function(){var e=[];for(var n=0;n<arguments.length;n++){if(typeof arguments[n]=="string"){e.push(arguments[n])}else if(arguments[n]!=undefined){e.push(JSON.stringify(arguments[n]))}}e=e.join(" ");if(this._cfg&&this._cfg.debug){alert(e)}else{console.log(e)}},_mixin:a,extend:function(e){return this._mixin(this,e)},_notImplemented:function s(e){e&&e.fail&&e.fail({errMsg:"ERR_NOT_IMPLEMENTED"})},isSupport:function(e){var n=this[e];return!!(n&&typeof n=="function"&&n!=o._notImplemented&&n._notReady!=true)}};if(window.DPApp){o=a(window.DPApp,o)}},{asyncDeps:v,map:m});define(d,[],function(e,n,t,r,i){var a=t.exports=function(e){var n=null;var t=null;var r={timeout:null,running:false,tasks:[],push:function(e,n){var t=n||function(e){};r.tasks.push({data:e,callback:t});setTimeout(function(){r.process()},0)},dequeue:function(){t&&t()},process:function(){if(r.tasks.length&&!r.running){var i=r.tasks.shift();r.running=true;t=function(){r.running=false;i.callback(i.data);r.process()};n=i.data;e(i.data,t)}}};return r}},{asyncDeps:v,map:m});define(p,[],function(e,n,t,r,i){t.exports=".dpapp-login-panel{position: fixed;width: 100%;top: 0;left: 0;background-color: #f0f0f0;height: 100%;padding: 20px;box-sizing: border-box;}.dpapp-login-panel .EasyLogin_row{margin: 0;padding: 5px 5px 5px 10px;overflow: hidden;border: 1px solid #ccc;background-color: #fff;margin-bottom: 10px;}.dpapp-login-panel .EasyLogin_row input{border: none;display: block;width: 120px;float: left;padding: 5px 0;font-size: 14px;height: 14px;}.dpapp-login-panel .EasyLogin_row .EasyLogin_send{text-decoration: none;color: #999;font-size: 14px;border: 1px solid #ccc;padding: 5px;border-radius: 4px;background-color: #fff;float: right;}.dpapp-login-panel .login-btn{border: none;margin: 0;display: block;width: 100%;background-color: #ff8400;height: 40px;margin-bottom: 12px;line-height: 40px;color: #fff;font-size: 18px;text-align: center;border-radius: 5px;}"},{asyncDeps:v,map:m})})();_use("dpapp@1.1.6",function(){});
/* dpShare.1.2.3 */
var DpShare=function(){return DpShare["init"].apply(DpShare,arguments)};(function(exp){var shareWX={appid:"wx841a97238d9e17b2",title:document.title,desc:"分享来自大众点评",content:"",feed:[DPApp.Share.WECHAT_FRIENDS,DPApp.Share.WECHAT_TIMELINE,DPApp.Share.WEIBO,DPApp.Share.QQ,DPApp.Share.QZONE,DPApp.Share.SMS,DPApp.Share.EMAIL,DPApp.Share.COPY],link:location.origin+location.pathname,img_url:"http://evt.dianping.com/midas/dper.jpg"};exp.init=function(opt){exp.ua=navigator.userAgent.toLowerCase();exp.initShareCallback=opt.initShareCallback;exp.initShareFail=opt.initShareFail;exp.getCXCallback=opt.getCXCallback;if(opt.shadowId){exp.shadowId=opt.shadowId}exp.wechat=0;exp.weibo=0;exp.tengxun=0;exp.changeShare(opt)};exp.changeShare=function(opts){for(var i in opts){if(opts[i]){if(i=="feed"){var feedArray=opts[i].split(","),feedF=[];feedArray.forEach(function(e){feedF.push(DPApp.Share[e])});shareWX[i]=feedF}else{shareWX[i]=opts[i]}}}shareWX.link=exp.hrefDelete(shareWX.link);shareWXTL={appid:shareWX.appid,title:"【"+shareWX.title+"】 "+shareWX.desc,desc:shareWX.desc,content:shareWX.content,link:shareWX.link,img_url:shareWX.img_url};exp.autoListenWx();if(exp.ua.match("dianping")){exp.DPAppReady(function(){exp.dpShareInit();exp.getCx()})}};exp.DPAppReady=function(callback){var find=function(locat){return location.origin.indexOf(locat)>-1};!(find("51ping")||find("dianping")||find("dpfile")||find("alpha"))&&DPApp.config({debug:true});DPApp.ready(function(){callback&&callback()})};exp.getCx=function(){if(exp.ua.match(/dianping/i)){DPApp.getCX({business:"adPay-emidasvip",success:function(e){exp.getCXCallback&&exp.getCXCallback(e)}})}};exp.btnShare=function(option){exp.changeShare(option);exp.initShareCallback=option.initShareCallback;if(exp.ua.match(/dianping/i)){DPApp.share({title:shareWX.title,desc:shareWX.desc,content:shareWX.content,image:shareWX.img_url,url:shareWX.link,feed:shareWX.feed,success:function(e){option.initShareCallback&&option.initShareCallback(e);Stts.special("分享成功")}})}exp.wechat=exp.ua.match("micromessenger")?1:0;if(exp.wechat||typeof WeixinJSBridge!="undefined"){if(option.shadowId){var shadowId=document.getElementById(option.shadowId);shadowId.style.display="block";setTimeout(function(){shadowId.addEventListener("click",function(){shadowId.style.display="none"},false)},1500)}else{div=document.createElement("div");div.style.width=innerWidth;div.style.height=innerHeight;div.style.position="fixed";div.style.top=0;div.style.left=0;div.style.right=0;div.style.bottom=0;div.style.zIndex=99999;div.style.backgroundColor="rgba(0,0,0,.8)";div.style.backgroundImage="url(http://si1.s1.dpfile.com/t/cssnew/events/labevent/seefilm/mmimages/share-cover-tips.e3893cb7ee521914fd768d05fab419b3.png)";div.style.backgroundRepeat="no-repeat";div.style.backgroundSize=100+"%";div.addEventListener("click",function(){this.parentNode.removeChild(this)},false);document.body.insertBefore(div,document.body.firstChild)}}exp.weibo=exp.ua.match("weibo")?1:0;exp.weibo&&(location.href="http://v.t.sina.com.cn/share/share.php?appkey=1392673069&url="+encodeURIComponent(shareWX.link)+"&title="+encodeURIComponent(shareWX.title+shareWX.desc)+"&content=utf-8"+"&pic="+encodeURIComponent(shareWX.img_url));exp.tengxun=exp.ua.match("tencentmicroblog")?1:0;exp.tengxun&&(location.href="http://share.v.t.qq.com/index.php?c=share&a=index&source=1000013&url="+encodeURIComponent(shareWX.link)+"&title="+encodeURIComponent(shareWX.title+shareWX.desc)+"&content=utf-8"+"&pic="+encodeURIComponent(shareWX.img_url))};exp.dpShareInit=function(){DPApp.initShare&&DPApp.initShare({title:shareWX.title,desc:shareWX.desc,content:shareWX.content,image:shareWX.img_url,url:shareWX.link,feed:shareWX.feed,success:function(){exp.initShareCallback&&exp.initShareCallback();Stts.special("分享成功")},fail:function(){exp.initShareFail&&exp.initShareFail()}})};exp.autoListenWx=function(){var wxFunction=function(){WeixinJSBridge.on("menu:share:appmessage",function(argv){WeixinJSBridge.invoke("sendAppMessage",shareWX,function(res){exp.initShareCallback&&exp.initShareCallback();Stts.special("分享成功")})});WeixinJSBridge.on("menu:share:timeline",function(argv){WeixinJSBridge.invoke("shareTimeline",shareWXTL,function(res){exp.initShareCallback&&exp.initShareCallback();Stts.special("分享成功")})})};if(window.WeixinJSBridge){wxFunction()}else{document.addEventListener("WeixinJSBridgeReady",function onBridgeReady(){wxFunction()},false)}};exp.hrefDelete=function(url){url=url.replace(/token=((\*)|(\w*))($|&)/g,"").replace(/version=((\*)|(\w*))($|&)/g,"").replace(/utm_source=(\w*)($|&)/g,"");if(url.indexOf("?")>-1){url+="&utm_source=o_weixin"}else{url+="?utm_source=o_weixin"}return url}})(DpShare);